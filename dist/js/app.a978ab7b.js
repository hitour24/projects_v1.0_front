(function(e){function t(t){for(var r,i,l=t[0],s=t[1],c=t[2],u=0,m=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&m.push(n[i][0]),n[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);d&&d(t);while(m.length)m.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,l=1;l<a.length;l++){var s=a[l];0!==n[s]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={app:0},o=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=s;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";a("85ec")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-app",[a("v-navigation-drawer",{attrs:{"mobile-breakpoint":0,"mini-variant":e.mini,dark:"",app:""},on:{"update:miniVariant":function(t){e.mini=t},"update:mini-variant":function(t){e.mini=t}},scopedSlots:e._u([{key:"append",fn:function(){return[e.mini?e._e():a("p",{staticClass:"text-center white--text caption"},[e._v(" Produced by MagicSoft 2021 ")])]},proxy:!0}])},[a("v-list",{attrs:{dense:"",app:""}},[a("v-list-item-group",{attrs:{dark:""},on:{change:function(){e.subMenuModel=null}}},[e._l(e.menu.filter((function(t){return!t.sub_items&&("admin"===e.$auth.roles()||!["Настройки","Пользователи","Цели","Продукты"].includes(t.name))})),(function(t){return a("router-link",{key:t.name,attrs:{tag:"v-list-item",to:t.path,"active-class":"active",exact:""}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"text-xs"},[e._v(" "+e._s(t.name))])],1)],1)})),e._l(e.menu.filter((function(t){return t.sub_items&&("admin"===e.$auth.roles()||!["Настройки","Пользователи"].includes(t.name))})),(function(t,r){return a("v-list-group",{key:r,attrs:{"no-action":"",color:""},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"text-xs"},[e._v(" "+e._s(t.name))])],1)]},proxy:!0}],null,!0),model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}},[a("v-list-item-group",{attrs:{dark:""},model:{value:e.subMenuModel,callback:function(t){e.subMenuModel=t},expression:"subMenuModel"}},e._l(t.sub_items,(function(t){return a("router-link",{key:t.name,attrs:{tag:"v-list-item",to:t.path,"active-class":"active",exact:""}},[a("v-list-item-icon",[a("v-icon")],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"text-xs"},[e._v(" "+e._s(t.name))])],1)],1)})),1)],1)}))],2)],1)],1),a("v-app-bar",{attrs:{dark:e.mini,flat:"",app:""}},[a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.mini=!e.mini}}}),a("v-spacer"),this.$auth.check()?e._e():a("v-col",{staticClass:"d-none d-md-flex",attrs:{cols:"auto"}},[a("v-btn",{staticClass:"new-btn mr-3",attrs:{elevation:"0",light:""},on:{click:function(t){e.$router.push({path:"login"}).catch((function(){}))}}},[e._v("Войти")]),a("v-btn",{staticClass:"new-btn",attrs:{elevation:"0",color:"primary"},on:{click:function(t){e.$router.push({path:"register"}).catch((function(){}))}}},[e._v("Зарегистрироваться")])],1),this.$auth.check()?a("v-col",{staticClass:"d-none d-md-flex",attrs:{cols:"auto"}},[a("v-menu",{attrs:{"close-on-content-click":!1,left:"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ml-3",staticStyle:{"font-size":"20px"},attrs:{elevation:"0",color:"primary",small:"",fab:""}},"v-btn",n,!1),r),[e._v(e._s(e.generateAvatar()))])]}}],null,!1,2707571406)},[a("div",{staticClass:"white",staticStyle:{"min-width":"320px","z-index":"2"}},[a("Account")],1)])],1):e._e()],1),a("v-main",[a("router-view")],1)],1)],1)},o=[],i=a("5530"),l=a("94ed"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-row",{staticClass:"pa-4",staticStyle:{"touch-action":"none !important"},attrs:{align:"center","no-gutters":"",justify:"start"}},[a("v-col",{attrs:{cols:"auto"}},[a("v-btn",{staticClass:"mr-3",staticStyle:{"font-size":"20px"},attrs:{elevation:"0",color:"primary",fab:""}},[e._v(e._s(e.generateAvatar()))])],1),a("v-col",[a("h3",[e._v(" "+e._s(this.$auth.user()&&"name"in this.$auth.user()?decodeURIComponent(this.$auth.user().name):"undefined")+" "+e._s(this.$auth.user()&&"sername"in this.$auth.user()?decodeURIComponent(this.$auth.user().sername):"undefined")+" ")]),a("v-row",{attrs:{"no-gutters":"",title:"Роль в системе"}},[a("v-icon",{staticClass:"mr-1"},[e._v("mdi-shield-account-outline")]),a("span",{staticClass:"subtitle-1 grey--text"},[e._v(e._s(this.$auth.user()&&"role_title"in this.$auth.user()?this.$auth.user().role_title:"undefined"))])],1),a("v-row",{attrs:{"no-gutters":"",title:"Эл. почта"}},[a("span",{staticClass:"subtitle-1 grey--text"},[e._v(e._s(this.$auth.user()&&"login"in this.$auth.user()?this.$auth.user().login:"undefined"))])])],1)],1),a("v-divider"),a("v-row",{attrs:{"no-gutters":""}},[a("v-list",{staticClass:"w-100",staticStyle:{"touch-action":"none !important"}},[a("v-list-item",{on:{click:function(t){e.$router.push({path:"/settings"}).catch((function(){}))}}},[a("v-list-item-title",[e._v("Настройки учетной записи")])],1),a("v-divider",{staticClass:"my-2"}),a("v-list-item",{on:{click:function(t){return e.$auth.logout()}}},[a("v-list-item-title",[e._v(" Выйти ")])],1)],1)],1)],1)},c=[],d=(a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("4de4"),a("b0c0"),a("fb6a"),a("ac1f"),a("1276"),a("a15b"),a("99af"),{unique:function(e,t){var a=new Set;return e.filter((function(e){return e?!a.has(e[t])&&a.add(e[t]):e}))},generateAvatar:function(){return this.$auth.user()?("name"in this.$auth.user()?decodeURIComponent(this.$auth.user().name).slice(0,1):"P")+("sername"in this.$auth.user()?decodeURIComponent(this.$auth.user().sername).slice(0,1):"P"):"PP"},arrayFromObject:function(e){var t=[];for(var a in e)t.push(e[a]);return t},groupBy:function(e,t){for(var a={},r=0;r<e.length;r++){var n=JSON.stringify(t(e[r]));n in a?a[n].push(e[r]):a[n]=[e[r]]}return this.arrayFromObject(a)},errorHandler:function(e){console.log("ERROR IN "+e);var t=e.response?e.response.data.message?e.response.data.message:e.message?e.message:JSON.stringify(e):e.message;return console.error(t),this.createToast("Ошибка! "+t,"error"),t},convertDateToFormat:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",a=e.split(".");return a.reverse(),a.join(t)},getLastDayOfMonth:function(e){var t=new Date((new Date).getFullYear(),e+1,0);return t.getDate()},getPeriodUnMonth:function(e){console.log(e);var t=new Date;return["".concat(t.getFullYear(),"-").concat(e<10?"0"+e:e,"-01"),"".concat(t.getFullYear(),"-").concat(e<10?"0"+e:e,"-").concat(this.getLastDayOfMonth(e-1))]},getToday:function(){var e=(new Date).toLocaleString("ru-RU").split(", ")[0].split(".");return"".concat(e[2],"-").concat(e[1],"-").concat(e[0])},createToast:function(e,t){r["default"].$toast(e,{type:t})}}),u={data:function(){return{}},methods:Object(i["a"])({},d)},m=u,p=a("2877"),f=Object(p["a"])(m,s,c,!1,null,null,null),h=f.exports,g={components:{Account:h},data:function(){return{subMenuModel:null,drawer:null,mini:!0,menu:[{name:"Проекты",path:"/",disabled:!1,icon:"mdi-view-split-vertical"},{name:"Цели",path:"/objectives",disabled:!1,icon:"mdi-image-filter-center-focus"},{name:"Продукты",path:"/products",disabled:!1,icon:"mdi-cube-outline"},{name:"Пользователи",path:"/members",disabled:!1,icon:"mdi-account-multiple-outline"},{name:"Настройки",path:"/settings",model:null,disabled:!1,sub_items:[{name:"Справочники",path:"/settings/catalogs",disabled:!1}],icon:l["b"]}]}},methods:Object(i["a"])({},d)},b=g,v=(a("034f"),Object(p["a"])(b,n,o,!1,null,null,null)),_=v.exports,w=a("8c4f"),x=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("div",{staticClass:"h-100",staticStyle:{background:"#f2f2f2"}},[r("v-row",{staticClass:"h-100 w-100",attrs:{"no-gutters":"",justify:"center",align:"center"}},[r("v-card",{staticClass:"pa-10 rounded-lg",attrs:{elevation:"0","max-width":"400px"}},[r("v-btn",{staticClass:"close-btn",attrs:{icon:"",light:""},on:{click:function(){e.$emit("close",!1),e.resetValidateSignIn(),e.alertErrorSignIn=!1,e.err=""}}},[r("v-icon",[t._v("mdi-close")])],1),r("v-row",{attrs:{"no-gutters":"",justify:"center"}},[r("v-card-title",{staticClass:"h1 pa-0 font-weight-bold"},[t._v("Вход в учетную запись")]),r("v-form",{ref:"formSignIn",staticClass:"w-100"},[r("v-alert",{staticClass:"mt-4",staticStyle:{"font-size":"14px !important"},attrs:{dense:"",text:"",color:"red",value:t.alertErrorSignIn}},[t._v(" "+t._s(t.err)+" ")]),t._l(t.signin,(function(e,a){return r("v-row",{key:a,staticClass:"my-4",attrs:{"no-gutters":""}},[r("h5",{staticClass:"w-100"},[t._v(t._s(e.label))]),r("v-text-field",{staticClass:"mt-1",attrs:{rules:"name"===a?[t.rules.required]:"email"===a?[t.rules.required,t.rules.emailMatch]:[t.rules.required],"background-color":"#ffffff",dense:"",outlined:"",type:e.type,disabled:e.disabled,placeholder:e.placeholder,"hide-details":"","prepend-inner-icon":e.icon},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"sign.model"}})],1)})),r("v-btn",{staticClass:"new-btn",attrs:{elevation:"0",block:"",loading:t.loading,disabled:t.loading,color:"primary"},on:{click:t.signIn}},[t._v("Войти")]),r("p",{staticClass:"subtitle-2 mb-0 mt-5 grey--text darken-3"},[t._v(" Нет аккаунта? "),r("v-btn",{staticClass:"link-btn",attrs:{small:"",text:"",color:"primary"},on:{click:function(){e.$emit("close",!1),e.$emit("iversion"),e.$router.push({path:"register"}),e.resetValidateSignIn(),e.alertErrorSignIn=!1,e.err=""}}},[t._v("Зарегистрируйтесь")])],1)],2)],1)],1)],1)],1)},y=[],j={data:function(){return{err:"",loading:!1,signin:{login:{label:"Эл. адрес",disabled:!1,placeholder:"ivan@example.com",icon:"",model:"",type:"text"},password:{label:"Пароль",disabled:!1,placeholder:"********",icon:"",model:"",type:"password"}},alertErrorSignIn:!1,rules:{required:function(e){return!!e||"Обязательное поле."},emailMatch:function(e){return/.+@.+\..+/.test(e)||"The email and password you entered don't match"}}}},methods:{validateSignIn:function(){return this.$refs.formSignIn.validate()},resetValidateSignIn:function(){this.$refs.formSignIn.reset()},signIn:function(){var e=this,t=this.$router.currentRoute.path;this.validateSignIn()&&(this.err="",this.loading=!0,this.alertErrorSignIn=!1,this.$auth.login({login:this.signin.login.model,password:this.signin.password.model}).then((function(a){e.loading=!1,console.warn("SUCCESS login",a,t),"/login"!==t&&(e.$emit("close",!1),e.resetValidateSignIn(),e.alertErrorSignIn=!1,e.err="",e.$router.push({path:t}))})).catch((function(t){e.loading=!1;var a=t.response?t.response.data.message?t.response.data.message:t.message?t.message:JSON.stringify(t):t.message;e.err=a,console.error("ERROR! in login",a),e.alertErrorSignIn=!0})))}}},k=j,R=Object(p["a"])(k,x,y,!1,null,null,null),C=R.exports,S=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("div",{staticClass:"h-100",staticStyle:{background:"#f2f2f2"}},[r("v-row",{staticClass:"h-100 w-100",attrs:{"no-gutters":"",justify:"center",align:"center"}},[r("v-card",{staticClass:"pa-10 rounded-lg",attrs:{elevation:"0","max-width":"400px"}},[r("v-btn",{staticClass:"close-btn",attrs:{icon:"",light:""},on:{click:function(){e.$emit("close",!1),e.resetValidateRegistration(),e.alertErrorCreateAccount=!1,e.err=""}}},[r("v-icon",[t._v("mdi-close")])],1),r("v-row",{attrs:{"no-gutters":"",justify:"center"}},[r("v-card-title",{staticClass:"h1 pa-0 font-weight-bold"},[t._v("Создать учетную запись")]),r("v-form",{ref:"formRegistration",staticClass:"w-100"},[r("v-alert",{staticClass:"mt-4",staticStyle:{"font-size":"14px !important"},attrs:{dense:"",text:"",color:"red",value:t.alertErrorCreateAccount}},[t._v(" "+t._s(t.err)+" ")]),t._l(t.registration,(function(e,a){return r("v-row",{key:a,staticClass:"my-4",attrs:{"no-gutters":""}},[r("h5",{staticClass:"w-100"},[t._v(t._s(e.label))]),r("v-text-field",{staticClass:"mt-1",attrs:{rules:["name","sername","password"].includes(a)?[t.rules.required]:"login"===a?[t.rules.required,t.rules.emailMatch]:[],"background-color":"#ffffff",dense:"",outlined:"",type:e.type,disabled:e.disabled,placeholder:e.placeholder,"hide-details":"","prepend-inner-icon":e.icon},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"reg.model"}})],1)})),r("v-btn",{staticClass:"new-btn",attrs:{elevation:"0",block:"",color:"primary",loading:t.loading,disabled:t.loading},on:{click:t.createAccount}},[t._v("Зарегистрироваться")]),r("p",{staticClass:"subtitle-2 mb-0 mt-5 grey--text darken-3"},[t._v(" Уже зарегистрировались? "),r("v-btn",{staticClass:"link-btn",attrs:{small:"",text:"",color:"primary"},on:{click:function(){e.$emit("close",!1),e.$emit("iversion"),e.$router.push({path:"login"}),e.resetValidateRegistration(),e.alertErrorCreateAccount=!1,e.err=""}}},[t._v("Войдите")])],1)],2)],1)],1)],1)],1)},A=[],O={data:function(){return{alertErrorCreateAccount:!1,err:"",loading:!1,rules:{required:function(e){return!!e||"Обязательное поле."},emailMatch:function(e){return/.+@.+\..+/.test(e)||"The email and password you entered don't match"}},registration:{name:{label:"Имя",disabled:!1,placeholder:"Иван",icon:"",model:"",type:"text"},sername:{label:"Фамилия",disabled:!1,placeholder:"Иванов",icon:"",model:"",type:"text"},secondname:{label:"Отчество",disabled:!1,placeholder:"Иванович",icon:"",model:"",type:"text"},login:{label:"Эл. адрес",disabled:!1,placeholder:"ivan@example.com",icon:"",model:"",type:"text"},password:{label:"Пароль",disabled:!1,placeholder:"********",icon:"",model:"",type:"password"}}}},methods:{validateRegistration:function(){return this.$refs.formRegistration.validate()},resetValidateRegistration:function(){this.$refs.formRegistration.reset()},createAccount:function(){var e=this,t=this.$router.currentRoute.path;this.validateRegistration()&&(this.alertErrorCreateAccount=!1,this.err="",this.loading=!0,this.$auth.register({name:this.registration.name.model,sername:this.registration.sername.model,secondname:this.registration.secondname.model,login:this.registration.login.model,password:this.registration.password.model}).then((function(a){e.loading=!1,console.warn("SUCCESS register",a.data),e.alertErrorCreateAccount=!1,"/register"!==t&&(e.$emit("close",!1),e.resetValidateRegistration(),e.alertErrorCreateAccount=!1,e.err="",e.$router.push({path:t}))})).catch((function(t){e.loading=!1,e.alertErrorCreateAccount=!0;var a=t.response?t.response.data.message?t.response.data.message:t.message?t.message:JSON.stringify(t):t.message;e.err=a,console.error("ERROR! in register",a)})))}}},$=O,T=Object(p["a"])($,S,A,!1,null,null,null),E=T.exports,I=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("div",[r("div",{staticClass:"ma-3"},[r("h1",[t._v("Проекты")]),r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{staticClass:"w-100"},[r("TableUnit",{attrs:{infoReport:t.infoReport,loadAddRaw:t.loadAddRaw,loading:t.loading,itemClasses:t.itemClasses,dataTable:t.dataTable[0],dialogAddItem:t.dialogAddItem,dialogRemove:t.dialogRemove,loadSubCatalog:t.loadSubCatalog,initRemoveRaw:t.removeRaw,editRaw:t.editRaw,helpbox:[{color:"red lighten-4",title:"в архиве"}],chips:{field:"members",slot:"item.members",filter:function(t){return t.id===e.$auth.user().id},color:function(e){return t.colorRoles[e.role_project_name]},title:"role_project"},linkAdd:t.linkAdd},on:{openEditDialog:t.openEditDialog,openAddDialog:t.openAddDialog,getSubCatalog:t.getSubCatalog,edit:t.edit,add:t.add,find:t.find,remove:t.remove,closwDialogAddItem:t.closwDialogAddItem,closeDialogRemove:t.closeDialogRemove,openDialogRemove:t.openDialogRemove,handleClickRow:t.handleClickRow}})],1)],1)],1)])},D=[],q=a("ade3"),P=a("1da1"),M=(a("96cf"),a("7db0"),a("d81d"),a("159b"),a("b64b"),a("caad"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-data-table",{staticClass:"elevation-0",attrs:{"show-group-by":e.showGroup,loading:e.loading,"item-class":e.itemClasses,"no-data-text":"Данные не найдены","mobile-breakpoint":"900",headers:e.dataTable.headers,items:e.dataTable.table,"items-per-page":50,"item-key":"id","show-select":e.dataTable.multi,"show-expand":!!e.expandable},on:{"click:row":e.handleClickRow},scopedSlots:e._u([e.chips?{key:e.chips.slot,fn:function(t){var r=t.item;return e._l(r[e.chips.field].filter(e.chips.filter),(function(t,r){return a("v-chip",{key:r,staticClass:"ma-1",attrs:{color:e.chips.color(t),dark:""}},[e._v(" "+e._s(null===t[e.chips.title]?e.chips.ifnull:t[e.chips.title])+" ")])}))}}:null,e.expandable?{key:"expanded-item",fn:function(t){var r=t.headers,n=t.item;return[a("td",{attrs:{colspan:r.length}},[n[e.expandable.field].length?a("v-data-table",{attrs:{"hide-default-footer":"",headers:Object.keys(n[e.expandable.field][0]).filter(e.expandable.filterFields).map((function(e){return{text:e,align:"start",sortable:!0,value:e,class:["nowrap","grey lighten-5"]}})),items:n[e.expandable.field]},scopedSlots:e._u([e.boolsCheckIcon?{key:e.boolsCheckIcon.slot,fn:function(t){var r=t.item;return[r[e.boolsCheckIcon.field]?a("v-icon",{attrs:{color:e.boolsCheckIcon.color}},[e._v(e._s(e.boolsCheckIcon.icon))]):a("span",[e._v(" - ")])]}}:null],null,!0)}):e._e()],1)]}}:null,e.actionsButtons?{key:"item.actions",fn:function(t){var r=t.item;return[a("v-icon",{staticClass:"mr-2",attrs:{disabled:r.default,small:""},on:{click:function(t){return e.openEditDialog(r,e.dataTable)}}},[e._v(" mdi-pencil ")]),a("v-icon",{attrs:{small:"",disabled:r.default},on:{click:function(){r["name_catalog"]=e.dataTable.name,e.removeRaw=r,e.$emit("openDialogRemove",!0)}}},[e._v(" mdi-delete ")])]}}:null,{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[e._v(e._s(e.dataTable.title)+" "),e.dataTable.tooltip?a("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){e.dialogHelpTooltip=!0,e.helpTooltip=e.dataTable.tooltip}}},[a("v-icon",{attrs:{size:"20"}},[e._v(e._s(e.dataTable.tooltipIcon)+" ")])],1):e._e()],1),a("v-spacer"),a("v-btn",{staticClass:"new-btn",attrs:{elevation:"0",color:"success"},on:{click:function(t){return e.openAddDialog(e.dataTable)}}},[e._v("Добавить")]),e.dataTable.add?a("v-dialog",{attrs:{persistent:"","max-width":"650px"},model:{value:e.dialogAddItem,callback:function(t){e.dialogAddItem=t},expression:"dialogAddItem"}},[a("v-card",[a("v-overlay",{attrs:{opacity:"0.8","z-index":"12",absolute:"",value:e.loadSubCatalog}},[a("v-row",{attrs:{"no-gutters":"",justify:"center"}},[a("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),a("v-row",{staticClass:"mt-3",attrs:{"no-gutters":"",justify:"center"}},[a("span",{staticClass:"subhead"},[e._v("Идет загрузка данных...")])])],1),a("v-card-title",[a("span",{staticClass:"text-h5"},[e._v(e._s(e.editRaw?e.dataTable.add.titleEdit:e.dataTable.add.title))])]),a("v-card-text",[a("v-container",[a("v-form",{ref:"formAddRawCatalog"},[a("v-row",e._l(e.dataTable.add.data.filter((function(e){return!e.hiddenDiaog})),(function(t){return a("v-col",{key:t.name,attrs:{cols:"12",sm:t.block?12:6}},["textarea"===t.type?a("v-textarea",{attrs:{rules:t.required?[e.rules.required]:[],"auto-grow":"",rows:"1",label:t.title},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"editFiled.model"}}):e._e(),"text"===t.type?a("v-text-field",{attrs:{"append-outer-icon":t.tooltipIcon&&!e.editRaw?t.tooltipIcon:"",rules:t.required?[e.rules.required]:[],placeholder:t.placeholder,label:t.title},on:{"click:append-outer":function(a){e.dialogHelpTooltip=!0,e.helpTooltip=t.tooltip}},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"editFiled.model"}}):e._e(),"date"===t.type?a("v-menu",{attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(r){var n=r.on,o=r.attrs;return[a("v-text-field",e._g(e._b({attrs:{rules:t.required?[e.rules.required]:[],label:t.title,"prepend-icon":"mdi-calendar",placeholder:t.placeholder,readonly:"",disabled:!!t.enabled&&!e.dataTable.add.data.find((function(e){return t.enabled===e.name})).model},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"editFiled.model"}},"v-text-field",o,!1),n))]}}],null,!0)},[a("v-date-picker",{attrs:{"no-title":""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"editFiled.model"}})],1):e._e(),"select"===t.type?a("v-autocomplete",{attrs:{"append-outer-icon":t.tooltipIcon&&!e.editRaw?t.tooltipIcon:"",disabled:t.disabled,multiple:t.multi,rules:t.required?[e.rules.required]:[],loading:e.loadSubCatalog,items:t.items?t.items:[],"item-text":["id_place","id_group","id_client","id_source"].includes(t.name)?function(e){return"id_place"===t.name?e.name+" - "+e.region:"id_group"===t.name?e.name+" "+e.performance:"id_client"===t.name?e.name+" - "+e.master_client:"id_source"===t.name?e.pool+" ("+e.client+") - "+e.coins:void 0}:t.itemText,"item-value":"id","return-object":"",label:t.title},on:{"click:append-outer":function(a){e.dialogHelpTooltip=!0,e.helpTooltip=t.tooltip},focus:function(a){return e.focusSubSelect(t)},change:function(a){t.model=a?a.id:null,t.multi&&(t.model=a),e.changeSubSelect(t)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("v-icon",{attrs:{color:"success"},on:{click:function(a){e.dialogAddTempItem=!0,e.addTempData=t.addTempData}}},[e._v(e._s(t.addTempItemIcon&&!e.editRaw?t.addTempItemIcon:""))])]},proxy:!0}],null,!0),model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"editFiled.model"}}):e._e(),"checkbox"===t.type?a("v-checkbox",{attrs:{"hide-details":"",label:t.title},on:{click:function(a){return e.focusSubSelect(t)}},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"editFiled.model"}}):e._e()],1)})),1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"new-btn",attrs:{color:"blue darken-1",text:"",disabled:e.loadAddRaw},on:{click:function(){e.$emit("closwDialogAddItem",!1),e.dataTable.add.data.forEach((function(e){e.model=null})),e.itemsSub=[],e.$refs.formAddRawCatalog.reset()}}},[e._v(" Отменить ")]),a("v-btn",{staticClass:"new-btn",attrs:{color:"blue darken-1",text:"",loading:e.loadAddRaw,disabled:e.loadAddRaw},on:{click:function(){e.editRaw?e.edit(e.dataTable.name,e.dataTable.add.data):e.add(e.dataTable.name,e.dataTable.add.data)}}},[e._v(" "+e._s(e.editRaw?"Обновить":"Добавить")+" ")])],1)],1)],1):e._e()],1),a("v-row",{staticClass:"grey lighten-5",attrs:{"no-gutters":""}},[a("SearchBlock",{attrs:{loadDataFilter:e.loadSubCatalog,filter:e.dataTable.add.data},on:{find:function(t){return e.find()},getCatalogFromBlock:e.getSubCatalog}})],1),a("v-divider"),a("v-row",{staticClass:"ma-0",attrs:{align:"center"}},[e.dataTable.multi?a("v-col",{attrs:{cols:"auto"}},[a("v-icon",{attrs:{disabled:!e.multiSelected.filter((function(e){return!e.default})).length,color:"red lighten-3"},on:{click:function(t){e.removeRaw={name_catalog:e.dataTable.name,id:e.multiSelected.map((function(e){return e.id}))},e.$emit("openDialogRemove",!0)}}},[e._v(" mdi-delete ")])],1):e._e(),a("v-col",{attrs:{cols:"auto"}},[e._v(" Всего записей - "),a("b",[e._v(e._s(e.infoReport.amount))])]),a("v-spacer"),e.helpbox&&e.helpbox.length?a("v-col",{attrs:{cols:"auto",sm:""}},[a("v-row",{attrs:{"no-gutters":"",align:"center",justify:"end"}},e._l(e.helpbox,(function(t){return a("v-col",{key:t.title,attrs:{cols:"auto"}},[a("v-col",{attrs:{cols:"auto"}},[a("v-row",{attrs:{"no-gutters":"",align:"center"}},[a("v-sheet",{attrs:{height:"15",width:"15",color:t.color}}),a("v-col",{staticClass:"ml-2",attrs:{cols:"auto"}},[e._v(" — "+e._s(t.title)+" ")])],1)],1)],1)})),1)],1):e._e()],1),a("v-divider")]},proxy:!0}],null,!0),model:{value:e.multiSelected,callback:function(t){e.multiSelected=t},expression:"multiSelected"}}),a("v-dialog",{attrs:{"max-width":"290"},model:{value:e.dialogHelpTooltip,callback:function(t){e.dialogHelpTooltip=t},expression:"dialogHelpTooltip"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5"},[e._v(" Помощь ")]),a("v-card-text",[a("span",{domProps:{innerHTML:e._s(e.helpTooltip)}})]),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"new-btn",attrs:{color:"green darken-1",text:""},on:{click:function(t){e.dialogHelpTooltip=!1}}},[e._v(" Понятно ")])],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialogRemove,callback:function(t){e.dialogRemove=t},expression:"dialogRemove"}},[a("v-card",[a("v-card-title",{staticClass:"text-h6"},[e._v("Вы уверены что хотите удалить эту строку?")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"new-btn",attrs:{color:"blue darken-1",text:"",disabled:e.loadAddRaw},on:{click:function(t){return e.$emit("closeDialogRemove",!1)}}},[e._v("Нет")]),a("v-btn",{staticClass:"new-btn",attrs:{color:"blue darken-1",text:"",loading:e.loadAddRaw,disabled:e.loadAddRaw},on:{click:e.remove}},[e._v("Да")]),a("v-spacer")],1)],1)],1)],1)}),F=[],N="http://37.143.12.185:3000/",U="api/entity/",z="api/entity/get/",L={CHECK_PASSWORD:"api/auth/cehckPassword",UPDATE_CONTACTS:"api/auth/updateContacts",UPDATE_NAME:"api/auth/updateName",UPDATE_SERNAME:"api/auth/updateSername",UPDATE_SECONDNAME:"api/auth/secondName",UPDATE_EMAIL:"api/auth/updateEmail",UPDATE_PASSWORD:"api/auth/updatePassword"},H={member:"grey",creator:"green",project_manager:"blue",null:"orange"},B={colorRoles:H,dialogErrorPermissions:!1,removeRaw:null,editRaw:null,resetFormAddEdit:!1,loading:!1,dialogAddItem:!1,dialogRemove:!1,loadSubCatalog:!1,loadAddRaw:!1,infoReport:{amount:0,sumShare1d:0},dialogHelpTooltip:!1,helpTooltip:"",tempSubItems:[],addTempData:!1,dialogAddTempItem:!1,rules:{required:function(e){return!1===e||!!e||"Обязательное поле."},emailMatch:function(e){return/.+@.+\..+/.test(e)||"The email and password you entered don't match"},doubleLogin:function(e,t){return e.items&&!e.items.find((function(e){return e.login===t}))||"Пользователь с таким логином уже есть в системе!"}}},V={removeRaw:null,itemsSub:[],multiSelected:[]},J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"w-100"},[e.filter.filter((function(e){return e.filter})).length?a("v-form",{ref:"formAddRawCatalog"},[a("v-row",{staticClass:"pa-0 ma-0",attrs:{align:"end"}},[e._l(e.filter.filter((function(e){return e.filter})),(function(t){return a("v-col",{key:t.name,attrs:{cols:"12",sm:"3"}},["text"===t.type?a("v-text-field",{attrs:{clearable:"",placeholder:t.placeholder,label:t.title,"hide-details":"",disabled:!!t.enabled&&!e.filter.filter((function(e){return e.filter})).find((function(e){return t.enabled===e.name})).model},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"filterEdit.model"}}):e._e(),"date"===t.type?a("v-menu",{ref:"menu",refInFor:!0,attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(r){var n=r.on,o=r.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Даты","prepend-icon":"mdi-calendar",readonly:"","hide-details":"",clearable:""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"filterEdit.model"}},"v-text-field",o,!1),n))]}}],null,!0),model:{value:e.dateReport,callback:function(t){e.dateReport=t},expression:"dateReport"}},[a("v-date-picker",{attrs:{range:"","no-title":""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"filterEdit.model"}},[a("v-spacer"),a("v-btn",{staticClass:"new-btn",attrs:{text:"",color:"primary"},on:{click:function(t){e.dateReport=!1}}},[e._v(" Cancel ")]),a("v-btn",{attrs:{lass:"new-btn",text:"",color:"primary"},on:{click:function(a){return e.$refs.menu[0].save(t.model)}}},[e._v(" OK ")])],1)],1):e._e(),"select"===t.type?a("v-autocomplete",{attrs:{color:t.color,disabled:!!t.enabled&&!e.filter.filter((function(e){return e.filter})).find((function(e){return t.enabled===e.name})).model,"hide-details":"",multiple:t.multi,loading:e.loadDataFilter,items:t.items?t.items:[],"item-text":function(e){return e.title},"item-value":"id","return-object":"",label:t.title,clearable:""},on:{change:function(a){t.model=a?a.id:null,t.multi&&(t.model=a),t.resetData&&!a&&e.filter.filter((function(e){return e.filter})).forEach((function(e){e.model=null})),e.filter.filter((function(e){return e.filter})).forEach((function(e){t.name===e.nameRatio&&(e.name=t.model)}))},focus:function(a){return e.getSubCatalog(t.name)}},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"filterEdit.model"}}):e._e(),"checkbox"===t.type?a("v-switch",{attrs:{"hide-details":"",label:t.title},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"filterEdit.model"}}):e._e()],1)})),a("v-col",{attrs:{sm:""}}),a("v-spacer"),a("v-col",{attrs:{cols:"auto"}},[a("v-btn",{staticClass:"new-btn",attrs:{elevation:"0",color:"primary"},on:{click:e.find}},[e._v("Искать")])],1)],2)],1):e._e()],1)},W=[],G={props:["filter","loadDataFilter"],data:function(){return Object(i["a"])(Object(i["a"])({},B),{},{dateReport:!1})},methods:{find:function(){this.$emit("find")},getSubCatalog:function(e){console.log(e),this.$emit("getCatalogFromBlock",e)}}},K=G,Y=Object(p["a"])(K,J,W,!1,null,null,null),Q=Y.exports,X={components:{SearchBlock:Q},props:["showGroup","infoReport","loadAddRaw","loading","itemClasses","dataTable","dialogAddItem","dialogRemove","loadSubCatalog","resetFormAddEdit","initRemoveRaw","editRaw","linkAdd","actionsButtons","helpbox","chips","expandable","boolsCheckIcon"],data:function(){return Object(i["a"])({rules:B.rules,dialogHelpTooltip:B.dialogHelpTooltip,helpTooltip:B.helpTooltip,tempSubItems:B.tempSubItems},V)},watch:{resetFormAddEdit:function(){this.$refs.formAddRawCatalog.reset()},initRemoveRaw:function(){this.removeRaw=null}},methods:{remove:function(){this.$emit("remove",this.removeRaw)},openEditDialog:function(e,t){this.$emit("openEditDialog",e,t)},openAddDialog:function(e){this.linkAdd?window.open(this.linkAdd):this.$emit("openAddDialog",e)},getSubCatalog:function(e){this.$emit("getSubCatalog",e)},edit:function(e,t){this.$refs.formAddRawCatalog.validate()&&this.$emit("edit",e,t)},add:function(e,t){this.$refs.formAddRawCatalog.validate()&&this.$emit("add",e,t)},find:function(){this.$emit("find",!0)},handleClickRow:function(e){this.$emit("handleClickRow",e)},focusSubSelect:function(e){this.$emit("focusSubSelect",e)},changeSubSelect:function(e){this.$emit("changeSubSelect",e)}}},Z=X,ee=Object(p["a"])(Z,M,F,!1,null,null,null),te=ee.exports,ae={loadCatalog:!1,sectionMoreCatalog:{},selectMoreCatalog:{},dataTable:[{name:"statuses_projects",title:"Статусы проекта",table:[],icon:l["a"],headers:[],multi:!0,add:{title:"Добавление статуса проекта",titleEdit:"Редактирование статуса проекта",name:"add_status_project",data:[{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",model:null,items:[],filter:!1,required:!1,block:!0}]}},{name:"statuses_products",title:"Статусы продукта",table:[],icon:l["a"],headers:[],multi:!0,add:{title:"Добавление статуса продукта",titleEdit:"Редактирование статуса продукта",name:"add_status_product",data:[{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",model:null,items:[],filter:!1,required:!1,block:!0}]}},{name:"statuses_objectives",title:"Статусы цели",table:[],icon:l["a"],headers:[],multi:!0,add:{title:"Добавление статуса цели",titleEdit:"Редактирование статуса цели",name:"add_status_objective",data:[{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",model:null,items:[],filter:!1,required:!1,block:!0}]}},{name:"roles",title:"Роли системы",table:[],icon:"mdi-shield-account-outline",headers:[],multi:!0,add:{title:"Добавление роли",titleEdit:"Редактирование роли",name:"add_roles",data:[{type:"text",title:"Имя",name:"name",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",model:null,items:[],filter:!1,required:!1,block:!0}]}},{name:"roles_project",title:"Роли проектов",table:[],icon:"mdi-briefcase-account-outline",headers:[],multi:!0,add:{title:"Добавление роли проекта",titleEdit:"Редактирование роли проекта",name:"add_roles_project",data:[{type:"text",title:"Имя",name:"name",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",model:null,items:[],filter:!1,required:!1,block:!0}]}},{name:"type_objective",title:"Типы целей",table:[],icon:l["d"],headers:[],multi:!0,add:{title:"Добавление статуса цели",titleEdit:"Редактирование статуса цели",name:"add_type_objective",data:[{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],filter:!0,required:!0,block:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",model:null,items:[],filter:!1,required:!1,block:!0}]}}]},re={dataTable:[{name:"projects",table:[],icon:"mdi-vector-triangle",headers:[],multi:!0,add:{title:"Добавление проекта",titleEdit:"Редактирование проекта",name:"add_project",data:[{type:"text",title:"ID",name:"id",placeholder:"",model:null,items:[],filter:!0,required:!0},{type:"text",title:"Название",name:"title",placeholder:"Например: Запуск ПЛ Север",model:null,items:[],filter:!0,required:!0},{type:"select",title:"Статус",name:"id_status_project",placeholder:"",model:null,required:!0,tooltip:'Вы можете создать статусы прямо отсюда, нажам на кнопку <b>+</b>, или перейти в <a href="/settings/catalogs" target="_blank">справчоники</a> и создать там',tooltipIcon:l["c"],addTempItemIcon:"mdi-plus-thick",addTempData:ae.dataTable[0].add.data,itemText:"title"},{type:"select",title:"Цели",name:"objectives",placeholder:"",model:null,required:!1,multi:!0,tooltip:'Вы можете создать цели прямо отсюда, нажам на кнопку <b>+</b>, или перейти в <a href="/objectives" target="_blank">цели</a> и создать там',tooltipIcon:l["c"],addTempItemIcon:"mdi-plus-thick",addTempData:[],itemText:"title"},{type:"select",title:"Продукты",name:"products",placeholder:"",model:null,required:!1,multi:!0,tooltip:'Вы можете создать продукты прямо отсюда, нажам на кнопку <b>+</b>, или перейти в <a href="/products" target="_blank">продукты</a> и создать там',tooltipIcon:l["c"],addTempItemIcon:"mdi-plus-thick",addTempData:[],itemText:"title"},{type:"select",title:"Участники",name:"members",placeholder:"",model:null,required:!1,multi:!0,tooltip:'Вы можете создать участников прямо отсюда, нажам на кнопку <b>+</b>, или перейти в <a href="/members" target="_blank">участники</a> и создать там',tooltipIcon:l["c"],addTempItemIcon:"mdi-plus-thick",addTempData:[],itemText:"title",block:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",block:!0,model:null,items:[],filter:!1,required:!0},{type:"text",title:"Варианты решения проблемы",name:"solution_options",placeholder:"",model:null,items:[],filter:!1,block:!0,required:!1},{type:"text",title:"Обоснование вариантов",name:"rationale_option",placeholder:"",model:null,items:[],filter:!1,block:!0,required:!1},{type:"text",title:"Иерархия продуктов (PBS)",name:"pbs",placeholder:"",model:null,required:!1},{type:"text",title:"Ссылка на план проекта (WBS)",name:"wbs",placeholder:"",model:null,required:!1},{type:"text",title:"Ресурсы (ссылка на ресурсный план) ",name:"resources",placeholder:"",model:null,filter:!1,required:!1},{type:"text",title:"Учет рисков, возможностей, проблем",name:"risks",placeholder:"",model:null,required:!1},{type:"checkbox",title:"Проработана цель и продукты проекта",name:"products_objectives",placeholder:"",model:null,required:!1},{type:"checkbox",title:"Утвержден план задач (WBS)",name:"task_plan",placeholder:"",model:null,required:!1},{type:"checkbox",title:"Есть РП, есть команда, есть время",name:"rp_command_time",placeholder:"",model:null,required:!1},{type:"checkbox",title:"Освобождены ресурсы РП для проекта",name:"rp_resource",placeholder:"",model:null,required:!1},{type:"checkbox",title:"Проекты выведен в реализацию (2 недели стартового трекинга",name:"start_realization",placeholder:"",model:null,required:!1},{type:"date",title:"Инициирован",name:"date_initiation",placeholder:"",model:null,required:!1},{type:"date",title:"Старт",name:"date_start",placeholder:"",model:null,required:!1},{type:"date",title:"Завершен (принят)",name:"date_completion",placeholder:"",model:null,required:!1},{type:"date",title:"Заморожен",name:"date_frozen",placeholder:"",model:null,required:!1},{type:"date",title:"Успешен",name:"date_success",placeholder:"",model:null,required:!1},{type:"checkbox",title:"Бизнес-модель и УТП: Требования + HR + доп.сервисы",name:"requirements_hr_addit_services",placeholder:"",model:null,required:!1},{type:"checkbox",title:"Жизненно-необходимые проекты",name:"vital",placeholder:"",model:null,required:!1}]}}]},ne=a("bc3a"),oe=a.n(ne),ie=a("2106"),le=a.n(ie),se=oe.a.create({baseURL:N,timeout:15e3,headers:{Accept:"application/json","Content-type":"application/json"}});r["default"].use(le.a,se);var ce={openDialogRemove:function(){this.dialogRemove=!0},closwDialogAddItem:function(){this.dialogAddItem=!1,this.editRaw=null},closeDialogRemove:function(){this.dialogRemove=!1},itemClasses:function(){return{nowrap:!0}},findCatalog:function(){var e=arguments,t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",n=e.length>1&&void 0!==e[1]?e[1]:{},a.next=4,t.$auth.refresh();case 4:return a.next=6,t.$auth.fetchUser();case 6:return o={"Content-type":"application/json",Authorization:"Bearer "+t.$auth.token()},a.next=9,new Promise((function(e,a){se.post("".concat(U).concat(r,"/find"),JSON.stringify(n),{headers:o}).then((function(t){t.data.items=t.data.items.map((function(e){var t=Object(i["a"])({},e);return e.from&&(t.from=d.convertDateToFormat(new Date(e.from).toLocaleString("ru-RU").split(", ")[0])),e.to&&(t.to=d.convertDateToFormat(new Date(e.to).toLocaleString("ru-RU").split(", ")[0])),e.date&&(t.date=d.convertDateToFormat(new Date(e.date).toLocaleString("ru-RU").split(", ")[0])),e.date_initiation&&(t.date_initiation=d.convertDateToFormat(new Date(e.date_initiation).toLocaleString("ru-RU").split(", ")[0])),e.date_completion&&(t.date_completion=d.convertDateToFormat(new Date(e.date_completion).toLocaleString("ru-RU").split(", ")[0])),e.date_frozen&&(t.date_frozen=d.convertDateToFormat(new Date(e.date_frozen).toLocaleString("ru-RU").split(", ")[0])),e.date_start&&(t.date_start=d.convertDateToFormat(new Date(e.date_start).toLocaleString("ru-RU").split(", ")[0])),e.date_success&&(t.date_success=d.convertDateToFormat(new Date(e.date_success).toLocaleString("ru-RU").split(", ")[0])),e.date_create&&(t.date_create=d.convertDateToFormat(new Date(e.date_create).toLocaleString("ru-RU").split(", ")[0])),t})),e(t)})).catch((function(e){401===e.response.status?t.$auth.logout():(d.errorHandler(e),t.loadInput=!1,t.loadAddRaw=!1,t.loadSubCatalog=!1),a()}))}));case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}}),a)})))()},prepareSubCatalogsNAmeEdit:function(e){switch(e){case"id_project":return"project";case"id_status_objective":case"id_status_product":return"status";case"id_type_objective":return"type_objective";case"id_parent_product":case"id_parent_objective":return"parent";case"id_role_project":return"role_project_title";default:return e}},prepareSubCatalogsNAme:function(e){switch(e){case"id_status_project":return"statuses_projects";case"id_project":return"projects";case"id_type_objective":return"type_objective";case"id_parent_objective":return"objectives";case"id_status_objective":return"statuses_objectives";case"id_parent_product":return"products";case"id_status_product":return"statuses_products";case"id_role":return"roles";case"id_role_project":return"roles_project";default:return e}},getCatalog:function(){var e=arguments,t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",a.next=3,t.$auth.refresh();case 3:return a.next=5,t.$auth.fetchUser();case 5:return n={"Content-type":"application/json",Authorization:"Bearer "+t.$auth.token()},a.next=8,new Promise((function(e,a){se.get("".concat(z).concat(r),{headers:n}).then((function(t){console.log(t.data.items),t.data.items=t.data.items.map((function(e){var t=Object(i["a"])({},e);return e.from&&(t.from=d.convertDateToFormat(new Date(e.from).toLocaleString("ru-RU").split(", ")[0])),e.to&&(t.to=d.convertDateToFormat(new Date(e.to).toLocaleString("ru-RU").split(", ")[0])),e.date&&(t.date=d.convertDateToFormat(new Date(e.date).toLocaleString("ru-RU").split(", ")[0])),t})),e(t)})).catch((function(e){401===e.response.status?t.$auth.logout():(d.errorHandler(e),t.loadInput=!1,t.loadAddRaw=!1,t.loadSubCatalog=!1),a()}))}));case 8:return a.abrupt("return",a.sent);case 9:case"end":return a.stop()}}),a)})))()},addToCatalog:function(){var e=arguments,t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",n=e.length>1&&void 0!==e[1]?e[1]:{},a.next=4,t.$auth.refresh();case 4:return a.next=6,t.$auth.fetchUser();case 6:return o={"Content-type":"application/json",Authorization:"Bearer "+t.$auth.token()},a.next=9,new Promise((function(e,a){se.post("".concat(U).concat(r),JSON.stringify(n),{headers:o}).then((function(t){d.createToast("Данные в справочник успешно добавлены","success"),e(t)})).catch((function(e){console.log(e),401===e.response.status?t.$auth.logout():(d.errorHandler(e),t.loadInput=!1,t.loadAddRaw=!1,t.loadSubCatalog=!1),a()}))}));case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}}),a)})))()},removeFromCatalog:function(){var e=arguments,t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",n=e.length>1?e[1]:void 0,a.next=4,t.$auth.refresh();case 4:return a.next=6,t.$auth.fetchUser();case 6:return o={"Content-type":"application/json",Authorization:"Bearer "+t.$auth.token()},console.log(n),a.next=10,new Promise((function(e,a){se.post("".concat(U).concat(r,"/remove"),JSON.stringify({id:n}),{headers:o}).then((function(t){d.createToast("Данные из справочника успешно удалены","success"),e(t)})).catch((function(e){401===e.response.status?t.$auth.logout():(d.errorHandler(e),t.loadInput=!1,t.loadAddRaw=!1,t.loadSubCatalog=!1),a()}))}));case 10:return a.abrupt("return",a.sent);case 11:case"end":return a.stop()}}),a)})))()},updateToCatalog:function(){var e=arguments,t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r,n,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",n=e.length>1&&void 0!==e[1]?e[1]:{},o=e.length>2?e[2]:void 0,a.next=5,t.$auth.refresh();case 5:return a.next=7,t.$auth.fetchUser();case 7:return i={"Content-type":"application/json",Authorization:"Bearer "+t.$auth.token()},a.next=10,new Promise((function(e,a){console.log(o,n),se.put("".concat(U).concat(r,"/").concat(o),JSON.stringify(n),{headers:i}).then((function(t){d.createToast("Данные в справочнике успешно обновлены","success"),e(t)})).catch((function(e){401===e.response.status?t.$auth.logout():(d.errorHandler(e),t.loadInput=!1,t.loadAddRaw=!1,t.loadSubCatalog=!1),a()}))}));case 10:return a.abrupt("return",a.sent);case 11:case"end":return a.stop()}}),a)})))()}},de={components:{TableUnit:te},data:function(){return Object(i["a"])(Object(i["a"])(Object(i["a"])({},re),B),{},{linkAdd:"/view/project?id=new"})},mounted:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.find();case 2:case"end":return t.stop()}}),t)})))()},methods:Object(i["a"])(Object(i["a"])({},ce),{},{remove:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),t.removeRaw=e,t.loadAddRaw=!0,a.next=5,t.removeFromCatalog(t.removeRaw.name_catalog,t.removeRaw.id);case 5:return a.next=7,t.find();case 7:t.loadAddRaw=!1,t.dialogRemove=!1,t.removeRaw=!t.removeRaw;case 10:case"end":return a.stop()}}),a)})))()},openEditDialog:function(e,t){console.log(e,t)},itemClasses:function(e){return{"red lighten-4":"архив"===e.status,nowrap:!0}},openAddDialog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialogAddItem=!0,t.loadSubCatalog=!0,a.next=4,Promise.all(e.add.data.map(function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("select"!==a.type){e.next=3;break}return e.next=3,t.getSubCatalog(a.name);case 3:return e.abrupt("return",Object(i["a"])({},a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:e.add.data=a.sent,t.loadSubCatalog=!1;case 6:case"end":return a.stop()}}),a)})))()},getSubCatalog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadSubCatalog=!0,console.log(e),a.next=4,t.getCatalog(t.prepareSubCatalogsNAme(e));case 4:return t.itemsSub=a.sent.data.items,t.dataTable.forEach((function(a){a.add&&a.add.data.forEach((function(a){a.name===e&&(a.items=t.itemsSub)}))})),t.loadSubCatalog=!1,a.abrupt("return",t.itemsSub);case 8:case"end":return a.stop()}}),a)})))()},edit:function(e,t){console.log("name",e,t)},add:function(e,t){console.log(e,t)},handleClickRow:function(e){window.open("/view/project?id="+e.id)},find:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("FIND "),a=e.dataTable[0],r=e.prepareSubCatalogsNAme("projects"),n=a.add.data.filter((function(e){return e.filter})).reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,t.multi&&t.model?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),e.loading=!0,t.next=7,e.findCatalog(r,n);case 7:o=t.sent.data,a.table=o.items,e.infoReport.amount=o.info.countRows,e.loading=!1,a.headers=a.table.length?Object.keys(a.table[0]).filter((function(e){return["title","status","members"].includes(e)})).map((function(e){return{text:"members"===e?"Моя роль в проекте":e,align:"start",sortable:!0,value:e,class:["nowrap","grey lighten-5"]}})):[],console.log(a),e.selectMoreCatalog=a;case 14:case"end":return t.stop()}}),t)})))()}})},ue=de,me=Object(p["a"])(ue,I,D,!1,null,null,null),pe=me.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"ma-3"},[a("h1",[e._v("Цели")]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"w-100"},[a("TableUnit",{attrs:{infoReport:e.infoReport,loadAddRaw:e.loadAddRaw,loading:e.loading,itemClasses:e.itemClasses,dataTable:e.dataTable[0],dialogAddItem:e.dialogAddItem,dialogRemove:e.dialogRemove,loadSubCatalog:e.loadSubCatalog,initRemoveRaw:e.removeRaw,editRaw:e.editRaw,actionsButtons:!0,showGroup:!0,helpbox:[{color:"yellow lighten-4",title:"дочерние цели"},{color:"red lighten-4",title:"в архиве"}]},on:{openEditDialog:e.openEditDialog,openAddDialog:e.openAddDialog,getSubCatalog:e.getSubCatalog,edit:e.edit,add:e.add,find:e.find,remove:e.remove,closwDialogAddItem:e.closwDialogAddItem,closeDialogRemove:e.closeDialogRemove,openDialogRemove:e.openDialogRemove,focusSubSelect:e.focusSubSelect}})],1)],1)],1)])},he=[],ge=(a("2532"),{filterParentObjectives:{"Основная решаемая проблема":[],"Решаемая проблема":["Основная решаемая проблема","Решаемая проблема"],"Сопутствующая цель":["Сопутствующая цель"],"Главный критерий успеха":["Главный критерий успеха"],"Критерий успеха":["Критерий успеха"],"Критерий завершения":["Критерий завершения"],"Условия реализации":["Условия реализации"],"Цель":["Цель"],"Основная цель":["Основная цель"],"Возможность":["Возможность"]},dataTable:[{parentColor:"yellow lighten-4",name:"objectives",table:[],icon:"mdi-vector-triangle",headers:[],multi:!1,add:{title:"Добавление цели",titleEdit:"Редактирование цели",name:"add_objectives",data:[{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],block:!0,filter:!0,required:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",block:!0,model:null,items:[],filter:!1,required:!0},{type:"select",title:"Проект",name:"id_project",placeholder:"",model:null,filter:!0,required:!0,tooltip:"Вы можете выбрать проект для этой цели или добавить цели прямо из проекта",tooltipIcon:l["c"],itemText:"title"},{type:"select",title:"Статус",name:"id_status_objective",placeholder:"",disabled:!1,model:null,required:!0,itemText:"title"},{type:"select",title:"Тип цели",name:"id_type_objective",placeholder:"",model:null,required:!0,filter:!0,itemText:"title"},{type:"select",title:"Цель-родитель",name:"id_parent_objective",placeholder:"",model:null,item_disabled:[],required:!1,tooltip:"Вы можете выбрать цель-родетля для иерархической структуры целей проекта",tooltipIcon:l["c"],itemText:"title"}]}}]}),be={components:{TableUnit:te},data:function(){return Object(i["a"])(Object(i["a"])({},ge),B)},mounted:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.find();case 2:case"end":return t.stop()}}),t)})))()},methods:Object(i["a"])(Object(i["a"])({},ce),{},{focusSubSelect:function(e){var t=this;if("id_parent_objective"===e.name){var a=this.dataTable[0].add.data.find((function(e){return"id_type_objective"===e.name}));if(console.log(a),a.model){var r=this.dataTable[0].add.data.find((function(e){return"id_status_objective"===e.name})),n=this.dataTable[0].add.data.find((function(e){return"id_project"===e.name}));e.items=e.itemsAll.filter((function(e){return e.id_project===n.model&&t.filterParentObjectives[a.items.find((function(e){return e.id===a.model})).title].includes(a.items.find((function(t){return t.id===e.id_type_objective})).title)&&"архив"!==r.items.find((function(t){return t.id===e.id_status_objective})).title&&e.id!==(t.editRaw?t.editRaw.id:"no")}))}}if(["id_type_objective","id_project","id_status_objective"].includes(e.name)){var o=this.dataTable[0].add.data.find((function(e){return"id_parent_objective"===e.name}));o.model=null}},itemClasses:function(e){return{"yellow lighten-4":e.parent,"red lighten-4":"архив"===e.status,nowrap:!0}},remove:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),t.removeRaw=e,t.loadAddRaw=!0,a.next=5,t.removeFromCatalog(t.removeRaw.name_catalog,t.removeRaw.id);case 5:return a.next=7,t.find();case 7:t.loadAddRaw=!1,t.dialogRemove=!1,t.removeRaw=!t.removeRaw;case 10:case"end":return a.stop()}}),a)})))()},openEditDialog:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.dialogAddItem=!0,e["name_catalog"]=t.name,a.editRaw=e,a.loadSubCatalog=!0,r.next=6,Promise.all(t.add.data.map(function(){var t=Object(P["a"])(regeneratorRuntime.mark((function t(r){var n,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e[a.prepareSubCatalogsNAmeEdit(r.name)],console.log("MODEL",n,e),"select"!==r.type){t.next=8;break}return t.next=5,a.getSubCatalog(r.name);case 5:o=function(){return r.items.filter((function(e){return n.split(",").includes(e.name)}))},l=function(){return console.log(r.items),r.items.find((function(e){var t=e[r.itemText];return console.log(n,t),n===t}))},n=r.multi?o():l()?l().id:n;case 8:return"id_status_objective"===r.name&&"активный"===r.items.find((function(e){return e.id===n})).title?r.disabled=!0:"id_status_objective"===r.name&&"архив"===r.items.find((function(e){return e.id===n})).title&&(r.disabled=!1),t.abrupt("return",Object(i["a"])(Object(i["a"])({},r),{},{model:n}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 6:t.add.data=r.sent,a.loadSubCatalog=!1;case 8:case"end":return r.stop()}}),r)})))()},openAddDialog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialogAddItem=!0,t.loadSubCatalog=!0,a.next=4,Promise.all(e.add.data.map(function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("select"!==a.type){e.next=4;break}return e.next=3,t.getSubCatalog(a.name);case 3:"id_status_objective"===a.name&&(a.disabled=!1);case 4:return e.abrupt("return",Object(i["a"])({},a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:e.add.data=a.sent,t.loadSubCatalog=!1;case 6:case"end":return a.stop()}}),a)})))()},getSubCatalog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadSubCatalog=!0,console.log(e),a.next=4,t.getCatalog(t.prepareSubCatalogsNAme(e));case 4:return t.itemsSub=a.sent.data.items,t.dataTable.forEach((function(a){a.add&&a.add.data.forEach((function(a){a.name===e&&(console.log("selects",a),a.items=t.itemsSub,a.itemsAll=t.itemsSub)}))})),t.loadSubCatalog=!1,a.abrupt("return",t.itemsSub);case 8:case"end":return a.stop()}}),a)})))()},edit:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(t),t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,"coins"===t.name&&t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),n=a.editRaw.id,a.loadAddRaw=!0,r.next=6,a.updateToCatalog(e,t,n);case 6:return r.next=8,a.find();case 8:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit,a.editRaw=null;case 12:case"end":return r.stop()}}),r)})))()},add:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(t),t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,"coins"===t.name&&t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),console.log(t),a.loadAddRaw=!0,r.next=6,a.addToCatalog(e,t);case 6:return r.next=8,a.find();case 8:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit;case 11:case"end":return r.stop()}}),r)})))()},find:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dataTable[0],r=e.prepareSubCatalogsNAme("objectives"),n=a.add.data.filter((function(e){return e.filter})).reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,t.multi&&t.model?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),e.loading=!0,t.next=6,e.findCatalog(r,n);case 6:o=t.sent.data,a.table=o.items,e.infoReport.amount=o.info.countRows,e.loading=!1,a.headers=a.table.length?Object.keys(a.table[0]).map((function(e){return{text:e,align:"start",sortable:!0,value:e,class:["nowrap","grey lighten-5"]}})).concat([{text:"actions",align:"start",sortable:!1,value:"actions",class:["nowrap","grey lighten-5"]}]):[],console.log(a),e.selectMoreCatalog=a;case 13:case"end":return t.stop()}}),t)})))()}})},ve=be,_e=(a("fec3"),Object(p["a"])(ve,fe,he,!1,null,"ec12064e",null)),we=_e.exports,xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"ma-3"},[a("h1",[e._v("Продукты")]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"w-100"},[a("TableUnit",{attrs:{infoReport:e.infoReport,loadAddRaw:e.loadAddRaw,loading:e.loading,itemClasses:e.itemClasses,dataTable:e.dataTable[0],dialogAddItem:e.dialogAddItem,dialogRemove:e.dialogRemove,loadSubCatalog:e.loadSubCatalog,initRemoveRaw:e.removeRaw,editRaw:e.editRaw,actionsButtons:!0,showGroup:!0,helpbox:[{color:"yellow lighten-4",title:"дочерние продукты"},{color:"red lighten-4",title:"в архиве"}]},on:{openEditDialog:e.openEditDialog,openAddDialog:e.openAddDialog,getSubCatalog:e.getSubCatalog,edit:e.edit,add:e.add,find:e.find,remove:e.remove,closwDialogAddItem:e.closwDialogAddItem,closeDialogRemove:e.closeDialogRemove,openDialogRemove:e.openDialogRemove,focusSubSelect:e.focusSubSelect}})],1)],1)],1)])},ye=[],je={dataTable:[{name:"products",table:[],icon:"mdi-vector-triangle",headers:[],multi:!1,add:{title:"Добавление продукта",titleEdit:"Редактирование продукта",name:"add_products",data:[{type:"text",title:"Название",name:"title",placeholder:"",model:null,items:[],filter:!0,required:!0},{type:"textarea",title:"Описание",name:"description",placeholder:"",block:!0,model:null,items:[],filter:!1,required:!0},{type:"checkbox",title:"Главный",name:"main",placeholder:"",block:!1,model:!1,items:[],filter:!0,required:!0},{type:"select",title:"Проект",name:"id_project",placeholder:"",model:null,required:!0,filter:!0,tooltip:"Вы можете выбрать проект для этого продукта или добавить продукт прямо из проекта",tooltipIcon:l["c"],itemText:"title"},{type:"select",title:"Статус",name:"id_status_product",placeholder:"",model:null,required:!0,filter:!1,itemText:"title"},{type:"select",title:"Продукт-родитель",name:"id_parent_product",placeholder:"",model:null,required:!1,tooltip:"Вы можете выбрать продукт-родетля для иерархической структуры продуктов проекта",tooltipIcon:l["c"],itemText:"title"},{type:"text",title:"Ссылка на финальный продукт",name:"finished_product",placeholder:"",block:!1,model:null,items:[],filter:!1,required:!1},{type:"date",title:"Дата добавления",name:"date_create",placeholder:"",block:!1,model:null,items:[],filter:!1,required:!0},{type:"date",title:"Дата завершения (приемки)",name:"date_completion",placeholder:"",block:!1,model:null,items:[],filter:!1,required:!1},{type:"date",title:"Дата исключения, заморозки",name:"date_frozen",placeholder:"",block:!1,model:null,items:[],filter:!1,required:!1}]}}]},ke={components:{TableUnit:te},data:function(){return Object(i["a"])(Object(i["a"])({},je),B)},mounted:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.find();case 2:case"end":return t.stop()}}),t)})))()},methods:Object(i["a"])(Object(i["a"])({},ce),{},{remove:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),t.removeRaw=e,t.loadAddRaw=!0,a.next=5,t.removeFromCatalog(t.removeRaw.name_catalog,t.removeRaw.id);case 5:return a.next=7,t.find();case 7:t.loadAddRaw=!1,t.dialogRemove=!1,t.removeRaw=!t.removeRaw;case 10:case"end":return a.stop()}}),a)})))()},focusSubSelect:function(e){var t=this;if("id_parent_product"===e.name){var a=this.dataTable[0].add.data.find((function(e){return"id_status_product"===e.name})),r=this.dataTable[0].add.data.find((function(e){return"id_project"===e.name})),n=this.dataTable[0].add.data.find((function(e){return"main"===e.name}));e.items=e.itemsAll.filter((function(e){return e.id_project===r.model&&e.main===n.model&&"архив"!==a.items.find((function(t){return t.id===e.id_status_product})).title&&e.id!==(t.editRaw?t.editRaw.id:"no")})),console.log(e.itemsAll)}if(["main","id_project"].includes(e.name)){var o=this.dataTable[0].add.data.find((function(e){return"id_parent_product"===e.name}));if("main"===e.name){var i=!e.model,l=e.model;this.dataTable[0].table.forEach((function(a){a.parent===t.editRaw.title&&l!==a.main&&(console.log(a),e.model=i,console.log(e.model,i))}))}o.model=!1}},itemClasses:function(e){return{"yellow lighten-4":e.parent,"red lighten-4":"архив"===e.status,nowrap:!0}},openEditDialog:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.dialogAddItem=!0,e["name_catalog"]=t.name,a.editRaw=e,a.loadSubCatalog=!0,r.next=6,Promise.all(t.add.data.map(function(){var t=Object(P["a"])(regeneratorRuntime.mark((function t(r){var n,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e[a.prepareSubCatalogsNAmeEdit(r.name)],console.log("MODEL",n,e),"select"!==r.type){t.next=8;break}return t.next=5,a.getSubCatalog(r.name);case 5:o=function(){return r.items.filter((function(e){return n.split(",").includes(e.name)}))},l=function(){return console.log(r.items),r.items.find((function(e){var t=e[r.itemText];return console.log(n,t),n===t}))},n=r.multi?o():l()?l().id:n;case 8:return"id_status_product"===r.name&&"активный"===r.items.find((function(e){return e.id===n})).title?r.disabled=!0:"id_status_product"===r.name&&"архив"===r.items.find((function(e){return e.id===n})).title&&(r.disabled=!1),t.abrupt("return",Object(i["a"])(Object(i["a"])({},r),{},{model:n}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 6:t.add.data=r.sent,console.log("selectMoreCatalog.add.data ",t.add.data),a.loadSubCatalog=!1;case 9:case"end":return r.stop()}}),r)})))()},openAddDialog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialogAddItem=!0,t.loadSubCatalog=!0,a.next=4,Promise.all(e.add.data.map(function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("select"!==a.type){e.next=4;break}return e.next=3,t.getSubCatalog(a.name);case 3:"id_status_product"===a.name&&(a.disabled=!1);case 4:return e.abrupt("return",Object(i["a"])({},a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:e.add.data=a.sent,t.loadSubCatalog=!1;case 6:case"end":return a.stop()}}),a)})))()},getSubCatalog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadSubCatalog=!0,console.log(e),a.next=4,t.getCatalog(t.prepareSubCatalogsNAme(e));case 4:return t.itemsSub=a.sent.data.items,t.dataTable.forEach((function(a){a.add&&a.add.data.forEach((function(a){a.name===e&&(a.items=t.itemsSub,a.itemsAll=t.itemsSub)}))})),t.loadSubCatalog=!1,a.abrupt("return",t.itemsSub);case 8:case"end":return a.stop()}}),a)})))()},edit:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(t),t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,"coins"===t.name&&t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),n=a.editRaw.id,a.loadAddRaw=!0,r.next=6,a.updateToCatalog(e,t,n);case 6:return r.next=8,a.find();case 8:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit,a.editRaw=null;case 12:case"end":return r.stop()}}),r)})))()},add:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(t),t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,"coins"===t.name&&t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),console.log(t),a.loadAddRaw=!0,r.next=6,a.addToCatalog(e,t);case 6:return r.next=8,a.find();case 8:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit;case 11:case"end":return r.stop()}}),r)})))()},find:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dataTable[0],r=e.prepareSubCatalogsNAme("products"),n=a.add.data.filter((function(e){return e.filter})).reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,t.multi&&t.model?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),e.loading=!0,t.next=6,e.findCatalog(r,n);case 6:o=t.sent.data,a.table=o.items,e.infoReport.amount=o.info.countRows,e.loading=!1,a.headers=a.table.length?Object.keys(a.table[0]).map((function(e){return{text:e,align:"start",sortable:!0,value:e,class:["nowrap","grey lighten-5"]}})).concat([{text:"actions",align:"start",sortable:!1,value:"actions",class:["nowrap","grey lighten-5"]}]):[],console.log(a),e.selectMoreCatalog=a;case 13:case"end":return t.stop()}}),t)})))()}})},Re=ke,Ce=(a("d59d"),Object(p["a"])(Re,xe,ye,!1,null,"43b4ece3",null)),Se=Ce.exports,Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"ma-3"},[a("h1",[e._v("Пользователи")]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"w-100"},[a("TableUnit",{attrs:{infoReport:e.infoReport,loadAddRaw:e.loadAddRaw,loading:e.loading,itemClasses:e.itemClasses,dataTable:e.dataTable[0],dialogAddItem:e.dialogAddItem,actionsButtons:!0,dialogRemove:e.dialogRemove,loadSubCatalog:e.loadSubCatalog,helpbox:[{color:"yellow lighten-4",title:"с проектом"},{color:"green lighten-4",title:"администраторы"}],expandable:{field:"projects",filterFields:function(e){return!["role","role_project"].includes(e)}},chips:{field:"projects",slot:"item.projects",ifnull:"Расширенные права",filter:function(e){return e},color:function(t){return e.colorRoles[t.role_project]},title:"role_project_title"},boolsCheckIcon:{field:"edit",slot:"item.edit",icon:"mdi-check-bold",color:"green"},initRemoveRaw:e.removeRaw,editRaw:e.editRaw},on:{openEditDialog:e.openEditDialog,openAddDialog:e.openAddDialog,getSubCatalog:e.getSubCatalog,edit:e.edit,add:e.add,find:e.find,remove:e.remove,closwDialogAddItem:e.closwDialogAddItem,closeDialogRemove:e.closeDialogRemove,openDialogRemove:e.openDialogRemove,changeSubSelect:e.changeSubSelect}})],1)],1)],1)])},Oe=[],$e={dataTable:[{name:"userauth",table:[],icon:"mdi-vector-triangle",headers:[],multi:!0,add:{title:"Добавление участников",titleEdit:"Редактирование участников",name:"add_members",data:[{type:"text",title:"Логин, 'эл. почта",name:"login",placeholder:"",model:null,items:[],filter:!0,required:!0,dialog:!0},{type:"text",title:"Имя",name:"name",placeholder:"",model:null,items:[],filter:!0,required:!0,dialog:!0},{type:"text",title:"Фамилия",name:"sername",placeholder:"",model:null,items:[],filter:!0,required:!0,dialog:!0},{type:"select",title:"Роль в системе",name:"id_role",placeholder:"",model:null,required:!0,filter:!0,dialog:!0,itemText:"title"},{type:"select",title:"Роль в проектах",name:"id_role_project",placeholder:"",model:null,required:!0,filter:!0,hiddenDiaog:!0,itemText:"title"},{type:"select",title:"Проект",name:"id_project",placeholder:"",model:null,required:!0,filter:!0,hiddenDiaog:!0,tooltip:"Вы можете выбрать проект для этого участника или добавить участника прямо из проекта",tooltipIcon:l["c"],itemText:"title"},{type:"text",title:"ID",name:"id",placeholder:"",model:null,filter:!0,required:!0,hiddenDiaog:!0},{type:"select",title:"Разрешено редактирование",name:"projects",placeholder:"",model:[],multi:!0,filter:!1,required:!0,hiddenDiaog:!0,block:"12",itemText:"title"},{type:"select",title:"Разрешено редактирование",name:"permissions",placeholder:"",model:[],items:[],multi:!1,filter:!1,required:!0,hiddenDiaog:!0}]}}]},Te={components:{TableUnit:te},data:function(){return Object(i["a"])(Object(i["a"])({},$e),B)},mounted:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.find();case 2:case"end":return t.stop()}}),t)})))()},methods:Object(i["a"])(Object(i["a"])({},ce),{},{changeSubSelect:function(e){if("id_role"===e.name){var t=this.dataTable[0].add.data.find((function(e){return"projects"===e.name}));t.hiddenDiaog=!0;var a=e.items.find((function(t){return t.id===e.model}));a=a?a.name:null,a&&"limited_admin"===a?t&&(t.hiddenDiaog=!1):a&&"limited_admin"!==a&&(t.model=[]),console.log("nameRole",a)}},remove:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.removeRaw=e,t.loadAddRaw=!0,a.next=4,t.removeFromCatalog(t.removeRaw.name_catalog,t.removeRaw.id);case 4:return a.next=6,t.find();case 6:t.loadAddRaw=!1,t.dialogRemove=!1,t.removeRaw=!t.removeRaw;case 9:case"end":return a.stop()}}),a)})))()},itemClasses:function(e){return{"yellow lighten-4":e.projects.length,"green lighten-4":"администратор"===e.role_title.toLowerCase(),nowrap:!0}},openEditDialog:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n,o,l,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log("selectMoreCatalog",t),a.dialogAddItem=!0,e["name_catalog"]=t.name,a.editRaw=e,a.loadSubCatalog=!0,n=t.add.data.find((function(e){return"projects"===e.name})),n.hiddenDiaog=!0,n.model=[],r.next=10,Promise.all(t.add.data.map(function(){var t=Object(P["a"])(regeneratorRuntime.mark((function t(r){var n,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e[a.prepareSubCatalogsNAmeEdit(r.name)],console.log("MODEL",n,e),"select"!==r.type){t.next=8;break}return t.next=5,a.getSubCatalog(r.name);case 5:o=function(){if("projects"!==r.name)return r.items.filter((function(e){return n.split(",").includes(e.name)}))},l=function(){return r.items.find((function(e){var t=e[r.itemText];return n===t}))},n=r.multi?o():l()?l().id:n;case 8:return t.abrupt("return",Object(i["a"])(Object(i["a"])({},r),{},{model:n}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 10:t.add.data=r.sent,o=t.add.data.find((function(e){return"id_role"===e.name})),a.changeSubSelect(o),l=t.add.data.find((function(e){return"permissions"===e.name})).items,s=t.add.data.find((function(e){return"projects"===e.name})),s.model=s.items.filter((function(e){return l.map((function(e){return e.id_project})).includes(e.id)})),console.log(o),"limited_admin"!==o.items.find((function(e){return e.id===o.model})).name&&(s.model=[]),a.loadSubCatalog=!1;case 19:case"end":return r.stop()}}),r)})))()},openAddDialog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.add.data.find((function(e){return"projects"===e.name})),r.hiddenDiaog=!0,r.model=[],t.dialogAddItem=!0,t.loadSubCatalog=!0,a.next=7,Promise.all(e.add.data.map(function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("select"!==a.type){e.next=3;break}return e.next=3,t.getSubCatalog(a.name);case 3:return e.abrupt("return",Object(i["a"])({},a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:e.add.data=a.sent,t.loadSubCatalog=!1;case 9:case"end":return a.stop()}}),a)})))()},getSubCatalog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadSubCatalog=!0,console.log(e),a.next=4,t.getCatalog(t.prepareSubCatalogsNAme(e));case 4:return t.itemsSub=a.sent.data.items,t.dataTable.forEach((function(a){a.add&&a.add.data.forEach((function(a){a.name===e&&(a.items=t.itemsSub)}))})),t.loadSubCatalog=!1,a.abrupt("return",t.itemsSub);case 8:case"end":return a.stop()}}),a)})))()},edit:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(t),t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,"coins"===t.name&&t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),n=a.editRaw.id,a.loadAddRaw=!0,r.next=6,a.updateToCatalog(e,t,n);case 6:return r.next=8,a.find();case 8:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit,a.editRaw=null;case 12:case"end":return r.stop()}}),r)})))()},add:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(t),t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,"coins"===t.name&&t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),console.log(t),a.loadAddRaw=!0,r.next=6,a.addToCatalog(e,t);case 6:return r.next=8,a.find();case 8:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit;case 11:case"end":return r.stop()}}),r)})))()},find:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dataTable[0],r=e.prepareSubCatalogsNAme("userauth"),console.log("find member",a.add.data),n=a.add.data.filter((function(e){return e.filter})).reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,t.multi&&t.model?t.model.map((function(e){return e.name})).join(","):void 0===t.model?null:t.model))}),{}),e.loading=!0,t.next=7,e.findCatalog(r,n);case 7:o=t.sent.data,a.table=o.items,e.infoReport.amount=o.info.countRows,e.loading=!1,a.headers=a.table.length?Object.keys(a.table[0]).filter((function(e){return["name","sername","login","role_title","projects"].includes(e)})).map((function(e){return{text:e,align:"start",sortable:!0,value:e,class:["nowrap","grey lighten-5"]}})).concat([{text:"actions",align:"start",sortable:!1,value:"actions",class:["nowrap","grey lighten-5"]}]):[],console.log(a),e.selectMoreCatalog=a;case 14:case"end":return t.stop()}}),t)})))()}})},Ee=Te,Ie=Object(p["a"])(Ee,Ae,Oe,!1,null,null,null),De=Ie.exports,qe=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("div",[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{staticClass:"pa-3",staticStyle:{"min-width":"300px"},attrs:{sm:"auto"}},[r("v-row",{staticClass:"pa-4",staticStyle:{"touch-action":"none !important"},attrs:{align:"center","no-gutters":"",justify:"start"}},[r("v-col",{attrs:{cols:"auto"}},[r("v-btn",{staticClass:"mr-3",staticStyle:{"font-size":"20px"},attrs:{elevation:"0",color:"primary",fab:""}},[t._v(t._s(t.generateAvatar()))])],1),r("v-col",[r("h3",[t._v(" "+t._s(this.$auth.user()&&"name"in this.$auth.user()?decodeURIComponent(this.$auth.user().name):"undefined")+" "+t._s(this.$auth.user()&&"sername"in this.$auth.user()?decodeURIComponent(this.$auth.user().sername):"undefined")+" ")]),r("v-row",{attrs:{"no-gutters":"",title:"Роль в системе"}},[r("v-icon",{staticClass:"mr-1"},[t._v("mdi-shield-account-outline")]),r("span",{staticClass:"subtitle-1 grey--text"},[t._v(t._s(this.$auth.user()&&"role_title"in this.$auth.user()?this.$auth.user().role_title:"undefined"))])],1),r("v-row",{attrs:{"no-gutters":"",title:"Эл. почта"}},[r("span",{staticClass:"subtitle-1 grey--text"},[t._v(t._s(this.$auth.user()&&"login"in this.$auth.user()?this.$auth.user().login:"undefined"))])])],1)],1),r("v-list",{staticClass:"ml-3"},[r("v-list-item-group",{model:{value:t.selectSection,callback:function(e){t.selectSection=e},expression:"selectSection"}},t._l(t.sections,(function(e,a){return r("v-row",{key:a,staticClass:"w-100",attrs:{"no-gutters":""}},[r("v-list-item",{attrs:{disabled:t.loadInput}},[r("v-list-item-title",[r("v-row",{attrs:{"no-gutters":"",align:"center",justify:"start"}},[r("v-icon",{staticClass:"mr-3"},[t._v(t._s(e.icon))]),t._v(" "+t._s(e.title)+" ")],1)],1)],1)],1)})),1)],1)],1),r("v-col",{staticClass:"pa-4",staticStyle:{"min-width":"300px"},attrs:{sm:""}},[t.loadInput?r("v-skeleton-loader",{attrs:{"max-width":"780","min-width":"300",type:"table-heading, list-item-three-line"}}):t._e(),t._l(t.sectionMore,(function(e,a){return r("v-row",{key:a,staticStyle:{"max-width":"760px"},attrs:{"no-gutters":""}},[r("h3",{staticClass:"w-100 mb-3"},[t._v(t._s(e.title))]),r("div",{staticClass:"w-100"},t._l(e.data,(function(a,n){return r("div",{key:n,staticClass:"w-100"},[r("v-row",{staticClass:"w-100",attrs:{align:"start","no-gutters":""}},[r("v-col",{staticClass:"mb-3"},[r("h4",{staticClass:"w-100"},[t._v(t._s(a.title))]),a.edit||a.inputs?t._e():r("div",{staticClass:"w-100 subtitle-1"},[t._v(" "+t._s(a.label?a.label:a.model)+" ")]),!a.edit&&a.inputs?r("div",{staticClass:"w-100 mt-2"},t._l(a.inputs,(function(e,a){return r("div",{key:a},[r("div",{staticClass:"subtitle-1"},[r("v-icon",[t._v(t._s(e.icon))]),t._v(" "+t._s(e.title)+" ")],1),r("div",{staticClass:"subtitle-2 grey--text ml-6"},[t._v(" "+t._s(""!==e.model&&e.model?e.model:" - ")+" ")])])})),0):t._e(),a.edit&&!a.inputs?r("v-row",{attrs:{"no-gutters":""}},[r("v-form",{ref:"formSaveData",refInFor:!0,staticClass:"w-100"},[r("v-alert",{staticClass:"mt-4",staticStyle:{"font-size":"14px !important"},attrs:{dense:"",text:"",color:"red",value:t.alertErrorSignIn}},[t._v(" "+t._s(t.err)+" ")]),r("v-col",{staticClass:"mr-3 mt-1 pa-0",attrs:{cols:"auto"}},[r("v-text-field",{attrs:{type:a.type,rules:a.required?[t.rules.required]:[],dense:"","hide-details":"",outlined:"",placeholder:a.placeholderEdit},model:{value:a.model,callback:function(e){t.$set(a,"model",e)},expression:"__more.model"}})],1),"password"===a.type?r("v-col",{staticClass:"mr-3 mt-2 pa-0",attrs:{cols:"auto"}},[r("v-text-field",{attrs:{type:a.type,rules:[t.rules.required],dense:"","hide-details":"",outlined:""},model:{value:a.modelCheck,callback:function(e){t.$set(a,"modelCheck",e)},expression:"__more.modelCheck"}})],1):t._e(),r("v-col",{staticClass:"pa-0",attrs:{cols:"auto"}},[r("v-btn",{staticClass:"new-btn mr-3 mt-2",attrs:{elevation:"0",light:""},on:{click:function(e){a.edit=!1,a.reset()}}},[t._v("Отмена")]),r("v-btn",{staticClass:"new-btn mt-2",attrs:{disabled:"password"===a.type&&(""===a.modelCheck||""===a.model||a.modelCheck!==a.model),loading:t.loading,elevation:"0",color:"primary"},on:{click:function(){t.$refs.formSaveData[0].validate()&&a.action(a.model,a)}}},[t._v("Сохранить")])],1)],1)],1):t._e()],1),r("v-col",{attrs:{cols:"auto"}},[a.edit?t._e():r("v-btn",{staticClass:"new-btn",attrs:{elevation:"0",light:""},on:{click:function(){a.auth?(t.modalSequrity=!0,t.editFiled={more:e,name:n}):a.edit=!0}}},[t._v(t._s(a.btn))])],1)],1),r("v-divider",{staticClass:"my-5"})],1)})),0)])}))],2)],1),r("v-dialog",{staticStyle:{"touch-action":"pan-y !important"},attrs:{scrollable:"","max-width":"400"},model:{value:t.modalSequrity,callback:function(e){t.modalSequrity=e},expression:"modalSequrity"}},[r("v-row",{staticClass:"h-100 w-100",attrs:{"no-gutters":"",justify:"center",align:"center"}},[r("v-card",{staticClass:"pa-10 rounded-lg",attrs:{elevation:"0",width:"400","max-width":"400"}},[r("v-btn",{staticClass:"close-btn",attrs:{icon:"",light:""},on:{click:function(){t.modalSequrity=!1,t.resetValidateSignIn(),t.password="",e.alertErrorSignIn=!1,e.err=""}}},[r("v-icon",[t._v("mdi-close")])],1),r("v-row",{attrs:{"no-gutters":"",justify:"center"}},[r("v-card-title",{staticClass:"h1 pa-0 text-center font-weight-bold",staticStyle:{"word-break":"keep-all"}},[t._v("Подтвердите текущий пароль")]),r("v-card-text",{staticClass:"text-center pt-4",staticStyle:{"word-break":"keep-all"}},[t._v("Чтобы обновить настройки учетной записи, нужно подтвердить пароль.")]),r("v-form",{ref:"formSignIn",staticClass:"w-100"},[r("v-alert",{staticClass:"mt-4",staticStyle:{"font-size":"14px !important"},attrs:{dense:"",text:"",color:"red",value:t.alertErrorSignIn}},[t._v(" "+t._s(t.err)+" ")]),r("v-text-field",{staticClass:"w-100",attrs:{placeholder:"Пароль",rules:[t.rules.required],"hide-details":"",dense:"",type:"password",outlined:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),r("v-row",{staticClass:"mt-4",attrs:{justify:"center","no-gutters":"",align:"center"}},[r("v-col",{staticClass:"pr-1",attrs:{sm:""}},[r("v-btn",{staticClass:"mt-2 new-btn",attrs:{block:"",elevation:"0",light:""},on:{click:function(){t.modalSequrity=!1,t.resetValidateSignIn(),t.password="",e.alertErrorSignIn=!1,e.err=""}}},[t._v("Отмена")])],1),r("v-col",{staticClass:"pl-1",attrs:{sm:""}},[r("v-btn",{staticClass:"mt-2 new-btn",attrs:{block:"",loading:t.loading,disabled:t.loading,elevation:"0",color:"primary"},on:{click:t.signIn}},[t._v("Подтвердить пароль")])],1)],1)],1)],1)],1)],1)],1)],1)},Pe=[],Me={password:null,modalSequrity:!1,loading:!1,rules:{required:function(e){return!!e||"Обязательное поле."},emailMatch:function(e){return/.+@.+\..+/.test(e)||"The email and password you entered don't match"}},selectSection:null,loadInput:!1,sectionMore:{},err:"",alertErrorSignIn:!1,findTags:[],sections:{account:{title:"Учетная запись",name:"account",icon:"mdi-account-circle-outline"},sequrity:{title:"Безопасность",name:"sequrity",icon:"mdi-lock-outline"}}},Fe={checkPassword:function(){var e=arguments,t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.$auth.refresh(),n={"Content-type":"application/json"},a.next=5,new Promise((function(e,a){se.post("".concat(L.CHECK_PASSWORD),JSON.stringify(r),{headers:n}).then((function(t){e(t)})).catch((function(e){t.loading=!1,t.err=d.errorHandler(e),t.alertErrorSignIn=!0,a()}))}));case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}),a)})))()},updateName:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={"Content-type":"application/json",Authorization:"Bearer "+a.$auth.token()},r.next=3,new Promise((function(r,o){se.put("".concat(L.UPDATE_NAME),JSON.stringify(e),{headers:n}).then((function(e){r(e)})).catch((function(e){401===e.response.status?a.$auth.logout():(t.edit=!0,a.loading=!1,a.err=d.errorHandler(e),a.alertErrorSignIn=!0),o()}))}));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()},updateSername:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={"Content-type":"application/json",Authorization:"Bearer "+a.$auth.token()},r.next=3,new Promise((function(r,o){se.put("".concat(L.UPDATE_SERNAME),JSON.stringify(e),{headers:n}).then((function(e){r(e)})).catch((function(e){401===e.response.status?a.$auth.logout():(t.edit=!0,a.loading=!1,a.err=d.errorHandler(e),a.alertErrorSignIn=!0),o()}))}));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()},updateSecondName:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={"Content-type":"application/json",Authorization:"Bearer "+a.$auth.token()},r.next=3,new Promise((function(r,o){se.put("".concat(L.UPDATE_SECONDNAME),JSON.stringify(e),{headers:n}).then((function(e){r(e)})).catch((function(e){401===e.response.status?a.$auth.logout():(t.edit=!0,a.loading=!1,a.err=d.errorHandler(e),a.alertErrorSignIn=!0),o()}))}));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()},updateContacts:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={"Content-type":"application/json",Authorization:"Bearer "+a.$auth.token()},r.next=3,new Promise((function(r,o){se.put("".concat(L.UPDATE_CONTACTS),JSON.stringify(e),{headers:n}).then((function(e){r(e)})).catch((function(e){401===e.response.status?a.$auth.logout():(t.edit=!0,a.loading=!1,a.err=d.errorHandler(e),a.alertErrorSignIn=!0),o()}))}));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()},updateLogin:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={"Content-type":"application/json",Authorization:"Bearer "+a.$auth.token()},r.next=3,new Promise((function(r,o){se.put("".concat(L.UPDATE_EMAIL),JSON.stringify(e),{headers:n}).then((function(e){r(e)})).catch((function(e){401===e.response.status?a.$auth.logout():(t.edit=!0,a.loading=!1,a.err=d.errorHandler(e),a.alertErrorSignIn=!0),o()}))}));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()},updatePassword:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={"Content-type":"application/json",Authorization:"Bearer "+a.$auth.token()},r.next=3,new Promise((function(r,o){se.put("".concat(L.UPDATE_PASSWORD),JSON.stringify(e),{headers:n}).then((function(e){r(e)})).catch((function(e){401===e.response.status?a.$auth.logout():(t.edit=!0,a.loading=!1,a.err=d.errorHandler(e),a.alertErrorSignIn=!0),o()}))}));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()}},Ne={data:function(){return Me},mounted:function(){this.selectSection=-1},watch:{selectSection:function(e){switch(console.log(e),this.sectionMore={},this.err="",this.alertErrorSignIn=!1,this.loadInput=!1,this.findTags=[],e){case 0:this.getAccountData();break;case 1:this.getSequrity();break;default:break}}},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Fe),d),{},{signIn:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.validateSignIn()){t.next=14;break}return e.err="",e.loading=!0,e.alertErrorSignIn=!1,a={email:e.$auth.user()&&"login"in e.$auth.user()?e.$auth.user().login:"",password:e.password},t.next=7,e.checkPassword(a);case 7:e.loading=!1,e.modalSequrity=!1,e.resetValidateSignIn(),e.password="",e.alertErrorSignIn=!1,e.err="",e.sectionMore[e.editFiled["more"]["name"]]["data"][e.editFiled["name"]].edit=!0;case 14:case"end":return t.stop()}}),t)})))()},saveName:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.err="",a.loading=!0,a.alertErrorSignIn=!1,n={name:e},r.next=6,a.updateName(n,t);case 6:a.loading=!1,a.alertErrorSignIn=!1,a.err="",t.edit=!1,a.$auth.fetchUser(),a.$auth.refresh();case 12:case"end":return r.stop()}}),r)})))()},saveSername:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.err="",a.loading=!0,a.alertErrorSignIn=!1,n={sername:e},r.next=6,a.updateSername(n,t);case 6:a.loading=!1,a.alertErrorSignIn=!1,a.err="",t.edit=!1,a.$auth.fetchUser(),a.$auth.refresh();case 12:case"end":return r.stop()}}),r)})))()},saveSecondname:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.err="",a.loading=!0,a.alertErrorSignIn=!1,n={secondname:""===e?" - ":e},r.next=6,a.updateSecondName(n,t);case 6:a.loading=!1,a.alertErrorSignIn=!1,a.err="",t.edit=!1,a.$auth.fetchUser(),a.$auth.refresh();case 12:case"end":return r.stop()}}),r)})))()},saveContacts:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.err="",a.loading=!0,a.alertErrorSignIn=!1,n={contacts:e},r.next=6,a.updateContacts(n,t);case 6:a.loading=!1,a.alertErrorSignIn=!1,a.err="",t.edit=!1,a.$auth.fetchUser(),a.$auth.refresh();case 12:case"end":return r.stop()}}),r)})))()},saveEmail:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.err="",a.loading=!0,a.alertErrorSignIn=!1,n={email:e},r.next=6,a.updateLogin(n,t);case 6:a.loading=!1,a.alertErrorSignIn=!1,a.err="",t.edit=!1,a.$auth.fetchUser(),a.$auth.refresh();case 12:case"end":return r.stop()}}),r)})))()},savePassword:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.err="",a.loading=!0,a.alertErrorSignIn=!1,n={password:e},r.next=6,a.updatePassword(n,t);case 6:a.loading=!1,a.alertErrorSignIn=!1,a.err="",t.edit=!1,a.$auth.logout();case 11:case"end":return r.stop()}}),r)})))()},resetValidateSignIn:function(){this.$refs.formSignIn.reset()},validateSignIn:function(){return this.$refs.formSignIn.validate()},getAccountData:function(){console.log("get data acc"),this.loadInput=!0,this.sectionMore={};var e=decodeURIComponent(this.$auth.user()&&"name"in this.$auth.user()?this.$auth.user().name:" - "),t=decodeURIComponent(this.$auth.user()&&"sername"in this.$auth.user()?this.$auth.user().sername:" - "),a=decodeURIComponent(this.$auth.user()&&"secondname"in this.$auth.user()?this.$auth.user().secondname:" - "),r=decodeURIComponent(this.$auth.user()&&"login"in this.$auth.user()?this.$auth.user().login:" - "),n=decodeURIComponent(this.$auth.user()&&"contacts"in this.$auth.user()?this.$auth.user().contacts:" - ");this.sectionMore={account:{name:"account",title:"Учетная запись",data:{name:{type:"text",name:"name",title:"Имя",btn:"Редактировать",action:this.saveName,reset:this.getAccountData,required:!0,model:e,edit:!1,auth:!1,placeholderEdit:"Имя"},sername:{type:"text",name:"sername",title:"Фамилия",btn:"Редактировать",required:!0,action:this.saveSername,reset:this.getAccountData,model:t,edit:!1,auth:!1,placeholderEdit:"Фамилия"},secondname:{type:"text",name:"secondname",title:"Отчество",btn:"Редактировать",action:this.saveSecondname,reset:this.getAccountData,model:a,edit:!1,auth:!1,placeholderEdit:"Фамилия"},email:{type:"text",name:"email",title:"Адрес электронной почты",btn:"Редактировать",required:!0,action:this.saveEmail,reset:this.getAccountData,model:r,edit:!1,auth:!0,placeholderEdit:"Email"},contacts:{type:"text",name:"contacts",title:"Контакты",btn:"Редактировать",required:!1,action:this.saveContacts,reset:this.getAccountData,model:n,edit:!1,auth:!1,placeholderEdit:"Контакты"}}}},console.log(this.sectionMore),this.loadInput=!1},getSequrity:function(){this.loadInput=!0,this.sectionMore={};var e=this.$auth.user()&&"update_date"in this.$auth.user()?new Date(this.$auth.user().update_date).toLocaleString("ru-RU").split(", ")[0]:" - ";this.sectionMore={sequrity:{name:"sequrity",title:"Безопасность",data:{password:{name:"password",title:"Пароль",btn:"Обновить",action:this.savePassword,type:"password",modelCheck:"",required:!0,reset:this.getSequrity,model:"",label:"Дата последнего обновления пароля: ".concat(e),edit:!1,auth:!0,placeholderEdit:"Пароль"}}}},this.loadInput=!1}})},Ue=Ne,ze=Object(p["a"])(Ue,qe,Pe,!1,null,null,null),Le=ze.exports,He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"ma-3"},[a("h1",[e._v("Справочники")]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"pl-0",staticStyle:{"min-width":"250px"},attrs:{sm:"auto"}},[a("v-row",{staticClass:"pt-2",staticStyle:{"touch-action":"none !important"},attrs:{align:"center","no-gutters":"",justify:"start"}},[a("v-col",{attrs:{cols:"auto"}},[a("v-list",[a("v-list-item-group",{attrs:{mandatory:"",color:"primary"},model:{value:e.sectionMoreCatalog,callback:function(t){e.sectionMoreCatalog=t},expression:"sectionMoreCatalog"}},e._l(e.dataTable,(function(t){return a("v-list-item",{key:t.name,attrs:{value:t}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"text-xs"},[e._v(" "+e._s(t.title))])],1)],1)})),1)],1)],1)],1)],1),a("v-col",{staticClass:"pa-4",staticStyle:{"min-width":"300px"},attrs:{sm:""}},[e.loadCatalog?a("v-skeleton-loader",{attrs:{"min-width":"300",type:"table-heading, list-item-three-line"}}):e._e(),a("v-row",{attrs:{"no-gutters":""}},[e.selectMoreCatalog.table?a("div",{staticClass:"w-100"},[a("TableUnit",{attrs:{actionsButtons:!0,infoReport:e.infoReport,loadAddRaw:e.loadAddRaw,loading:e.loading,itemClasses:e.itemClasses,dataTable:e.selectMoreCatalog,dialogAddItem:e.dialogAddItem,dialogRemove:e.dialogRemove,loadSubCatalog:e.loadSubCatalog,resetFormAddEdit:e.resetFormAddEdit,initRemoveRaw:e.removeRaw,editRaw:e.editRaw},on:{openEditDialog:e.openEditDialog,openAddDialog:e.openAddDialog,getSubCatalog:e.getSubCatalog,edit:e.edit,add:e.add,find:e.find,remove:e.remove,closwDialogAddItem:e.closwDialogAddItem,closeDialogRemove:e.closeDialogRemove,openDialogRemove:e.openDialogRemove}})],1):e._e()])],1)],1)],1)])},Be=[],Ve={components:{TableUnit:te},data:function(){return Object(i["a"])(Object(i["a"])({},ae),B)},methods:Object(i["a"])(Object(i["a"])({},ce),{},{remove:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadAddRaw=!0,a.next=3,t.removeFromCatalog(e.name_catalog,e.id);case 3:return a.next=5,t.get();case 5:t.loadAddRaw=!1,t.dialogRemove=!1,t.removeRaw=!t.removeRaw;case 8:case"end":return a.stop()}}),a)})))()},edit:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(t),t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,"coins"===t.name&&t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),n=a.editRaw.id,a.loadAddRaw=!0,r.next=6,a.updateToCatalog(e,t,n);case 6:return r.next=8,a.get();case 8:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit,a.editRaw=null;case 12:case"end":return r.stop()}}),r)})))()},add:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t=t.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,t.multi?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),a.loadAddRaw=!0,r.next=4,a.addToCatalog(e,t);case 4:return r.next=6,a.get();case 6:a.loadAddRaw=!1,a.dialogAddItem=!1,a.resetFormAddEdit=!a.resetFormAddEdit;case 9:case"end":return r.stop()}}),r)})))()},find:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.sectionMoreCatalog,console.log(a),r=e.prepareSubCatalogsNAme(a.name),n=e.selectMoreCatalog.add.data.filter((function(e){return e.filter})).reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),Object(q["a"])({},t.name,t.multi&&t.model?t.model.map((function(e){return e.name})).join(","):t.model))}),{}),e.loadingFind=!0,t.next=7,e.findCatalog(r,n);case 7:o=t.sent.data,a.table=o.items,e.infoReport.amount=o.info.countRows,e.loadingFind=!1,a.headers=a.table.length?Object.keys(a.table[0]).map((function(e){return{text:e,align:"start",sortable:!0,value:e,class:["nowrap","grey lighten-5"]}})).concat([{text:"actions",align:"start",sortable:!1,value:"actions",class:["nowrap","grey lighten-5"]}]):[],console.log(a),e.selectMoreCatalog=a;case 14:case"end":return t.stop()}}),t)})))()},getSubCatalog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadSubCatalog=!0,console.log(e),a.next=4,t.getCatalog(t.prepareSubCatalogsNAme(e));case 4:return t.itemsSub=a.sent.data.items,t.dataTable.forEach((function(a){a.add&&a.add.data.forEach((function(a){a.name===e&&(a.items=t.itemsSub)}))})),t.loadSubCatalog=!1,a.abrupt("return",t.itemsSub);case 8:case"end":return a.stop()}}),a)})))()},openAddDialog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialogAddItem=!0,t.loadSubCatalog=!0,a.next=4,Promise.all(e.add.data.map(function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("select"!==a.type){e.next=3;break}return e.next=3,t.getSubCatalog(a.name);case 3:return e.abrupt("return",Object(i["a"])({},a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:e.add.data=a.sent,t.loadSubCatalog=!1;case 6:case"end":return a.stop()}}),a)})))()},openEditDialog:function(e,t){var a=this;return Object(P["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.dialogAddItem=!0,e["name_catalog"]=t.name,a.editRaw=e,a.loadSubCatalog=!0,r.next=6,Promise.all(t.add.data.map(function(){var t=Object(P["a"])(regeneratorRuntime.mark((function t(r){var n,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e[a.prepareSubCatalogsNAme(r.name)],"select"!==r.type){t.next=7;break}return t.next=4,a.getSubCatalog(r.name);case 4:o=function(){return r.items.filter((function(e){return n.split(",").includes(e.name)}))},l=function(){return r.items.find((function(e){var t=e.name;return console.log(n,t),n===t}))},n=r.multi?o():l()?l().id:n;case 7:return t.abrupt("return",Object(i["a"])(Object(i["a"])({},r),{},{model:n}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 6:t.add.data=r.sent,a.loadSubCatalog=!1;case 8:case"end":return r.stop()}}),r)})))()},get:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.sectionMoreCatalog,a.add.data=a.add.data.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{model:null})})),e.selectMoreCatalog={},e.loadCatalog=!0,t.next=6,e.getCatalog(a.name);case 6:r=t.sent.data,a.table=r.items,e.infoReport.amount=r.info.countRows,console.log(a.table),e.loadCatalog=!1,a.headers=a.table.length?Object.keys(a.table[0]).map((function(e){return{text:e,align:"start",sortable:!0,value:e,class:["nowrap","grey lighten-5"]}})).concat([{text:"actions",align:"start",sortable:!1,value:"actions",class:["nowrap","grey lighten-5"]}]):[],console.log(a),e.selectMoreCatalog=a;case 14:case"end":return t.stop()}}),t)})))()}}),watch:{sectionMoreCatalog:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.get();case 2:case"end":return t.stop()}}),t)})))()}}},Je=Ve,We=Object(p["a"])(Je,He,Be,!1,null,null,null),Ge=We.exports,Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"ma-3"},[a("v-overlay",{attrs:{opacity:"0.8","z-index":"10000",value:e.loadSubCatalog}},[a("v-row",{attrs:{"no-gutters":"",justify:"center"}},[a("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),a("v-row",{staticClass:"mt-3",attrs:{"no-gutters":"",justify:"center"}},[a("span",{staticClass:"subhead"},[e._v("Идет загрузка данных...")])])],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"auto",sm:""}},[a("v-form",{ref:"formProjectData"},e._l(e.formProject,(function(t){return a("v-col",{key:t.name,class:"pa-1 "+("head_select"===t.type?"sticky_head":""),attrs:{cols:"12",sm:t.block}},[a("v-row",{staticClass:"w-100",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",md:"3"}},["head_select"===t.type?a("h1",[e._v("Проект")]):"list"===t.type?a("div",{class:"pa-4 font-weight-bold h-100 "+t.color,staticStyle:{"word-break":"break-all","font-size":"14px !important"},attrs:{cols:"12"}},[e._v(" "+e._s(t.description)+" ")]):e._e()]),a("v-col",{attrs:{cols:"12",md:""}},["head_select"===t.type?a("v-row",{attrs:{"no-gutters":"",align:"center"}},[a("v-col",{attrs:{cols:"12",md:"9"}},[e.$route.query.id&&"new"===e.$route.query.id?a("v-text-field",{staticClass:"head_big_font",attrs:{rules:[e.rules.required],"background-color":"light-green accent-3",flat:"",solo:"","hide-no-data":"",placeholder:"Название проекта","hide-details":""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"unitForm.model"}}):"edit"===e.mode?a("v-text-field",{staticClass:"head_big_font",attrs:{rules:[e.rules.required],"background-color":"light-green accent-3",flat:"",solo:"","hide-no-data":"",placeholder:"Название проекта","hide-details":""},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"unitForm.text"}}):a("v-autocomplete",{staticClass:"head_big_font",attrs:{"background-color":"light-green accent-3",flat:"",solo:"","hide-no-data":"","hide-details":"",loading:e.loadSubCatalog,disabled:"edit"===e.mode,items:e.allProjects,"item-text":"title","item-value":"id"},on:{change:e.getDataProject},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"unitForm.model"}})],1),a("v-col",{attrs:{cols:"12",md:""}},["head_select"===t.type&&"view"===e.mode&&e.permission()?a("v-btn",{staticClass:"new-btn",attrs:{block:"",large:"",loading:e.loadingStartEdit,text:"",color:"primary"},on:{click:function(t){e.mode="edit"}}},[e._v(" Редактировать ")]):e._e(),"head_select"===t.type&&"edit"===e.mode?a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"6"}},[a("v-btn",{staticClass:"new-btn",attrs:{block:"",large:"",text:"",color:"red"},on:{click:e.cancelEditProject}},[e._v(" Отмена ")])],1),a("v-col",{attrs:{cols:"6"}},[a("v-btn",{staticClass:"new-btn",attrs:{block:"",large:"",text:"",color:"success"},on:{click:e.saveEditProject}},[e._v(" "+e._s(e.$route.query.id&&"new"===e.$route.query.id?"Создать":"Сохранить")+" ")])],1)],1):e._e()],1)],1):e._e(),"textarea"===t.type?a("v-textarea",{attrs:{readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,"hide-details":"","auto-grow":"",rows:"1",placeholder:t.title},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"unitForm.model"}}):e._e(),"list"===t.type?a("v-list",{ref:t.ref,refInFor:!0,staticClass:"py-1",staticStyle:{"word-break":"break-all",position:"relative","font-size":"14px !important"},attrs:{append:"",flat:"",color:t.color}},["edit"===e.mode?a("v-btn",{staticClass:"control_button",attrs:{fab:"",color:"primary",dark:"",elevation:"0","x-small":"",ripple:!1},on:{click:function(a){return e.addEntityLocal(t)}}},[a("v-icon",[e._v("mdi-plus-thick")])],1):e._e(),e._l(t.data.filter((function(e){return!e.remove})),(function(r,n){return[a("v-list-item",{key:n+4,ref:r.ref,refInFor:!0,staticClass:"item_raw",staticStyle:{position:"relative","font-size":"14px !important"}},["edit"===e.mode?a("v-btn",{staticClass:"control_button_remove",attrs:{fab:"",color:"red lighten-1",dark:"",elevation:"0","x-small":"",ripple:!1},on:{click:function(a){return e.removeEntityLocal(t,r)}}},[a("v-icon",[e._v(e._s(e.icons.minus))])],1):e._e(),a("v-list-item-icon",{staticClass:"mr-3"},[e._v(" "+e._s(r.hierarchy)+" ")]),a("v-list-item-content",{staticClass:"py-1"},[a("v-list-item-title",[a("v-text-field",{staticStyle:{color:"rgba(0, 0, 0, 1) !important","font-weight":"700 !important","font-size":"14px !important"},attrs:{placeholder:"Название",light:"",readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,dense:"",flat:"","hide-details":"auto",rules:[e.rules.required]},model:{value:r.title,callback:function(t){e.$set(r,"title",t)},expression:"item.title"}})],1),a("v-list-item-subtitle",[a("v-textarea",{staticStyle:{"font-size":"14px !important"},attrs:{placeholder:"Описание",dense:"",rows:"1","auto-grow":"",light:"",readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,flat:"","hide-details":"auto",rules:[e.rules.required]},model:{value:r.description,callback:function(t){e.$set(r,"description",t)},expression:"item.description"}}),"edit"===e.mode&&t.data.find((function(e){return!e.remove&&e.index!==r.index&&r.index>e.index&&e.title}))?a("v-autocomplete",{staticStyle:{color:"rgba(0, 0, 0, 1) !important","font-weight":"700 !important","font-size":"14px !important"},attrs:{placeholder:"Родительский пункт",light:"",dense:"",clearable:"",flat:"","hide-details":"auto",items:t.data.filter((function(e){return!e.remove&&e.index!==r.index&&r.index>e.index&&e.title})),"item-text":function(e){return e.hierarchy+" - "+e.title},"item-value":"index"},on:{change:e.generateHierarchy},model:{value:r.parent,callback:function(t){e.$set(r,"parent",t)},expression:"item.parent"}}):e._e(),"products_0"!==t.name&&"products_1"!==t.name&&"products_2"!==t.name&&"products_3"!==t.name&&"products_4"!==t.name&&"products_5"!==t.name||"edit"!==e.mode?e._e():a("v-text-field",{staticStyle:{color:"rgba(0, 0, 0, 1)","font-weight":"700 !important","font-size":"14px !important"},attrs:{placeholder:"Ссылка на финальный продукт",light:"",readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,dense:"",flat:"","hide-details":"auto"},model:{value:r.finished_product,callback:function(t){e.$set(r,"finished_product",t)},expression:"item.finished_product"}}),"products_0"!==t.name&&"products_1"!==t.name&&"products_2"!==t.name&&"products_3"!==t.name&&"products_4"!==t.name&&"products_5"!==t.name||"edit"!==e.mode?e._e():a("div",e._l([{title:"Дата добавления",name:"date_create"},{title:"Дата завершения (приемки)",name:"date_completion"},{title:"Дата исключения, заморозки",name:"date_frozen"}],(function(t){return a("v-menu",{key:t.name,attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,i=n.attrs;return[a("v-text-field",e._g(e._b({staticClass:"pt-0",staticStyle:{color:"rgba(0, 0, 0, 1)","font-weight":"700 !important","font-size":"14px !important"},attrs:{"prepend-inner-icon":"mdi-calendar",light:"",readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,dense:"",flat:"",placeholder:t.title,"hide-details":"auto"},model:{value:r[t.name],callback:function(a){e.$set(r,t.name,a)},expression:"item[dateProduct.name]"}},"v-text-field",i,!1),o))]}}],null,!0)},[a("v-date-picker",{attrs:{"no-title":""},model:{value:r[t.name],callback:function(a){e.$set(r,t.name,a)},expression:"item[dateProduct.name]"}})],1)})),1)],1)],1)],1),n<t.data.length-1?a("v-divider",{key:n+40}):e._e()]}))],2):e._e(),"label_input_block"===t.type?a("div",[a("v-col",{staticStyle:{"font-size":"14px"},attrs:{cols:"12",sm:t.block}},[a("v-row",{staticClass:"pa-1 grey lighten-5",attrs:{align:"end"}},e._l(t.data,(function(r){return a("v-col",{key:r.name,staticClass:"pa-2 item_raw_member",staticStyle:{position:"relative"},attrs:{md:r.block,cols:"12"}},["checkbox"!==r.type?a("span",[e._v(" "+e._s(r.title))]):e._e(),"text"===r.type&&"members"!==t.name?a("v-text-field",{staticClass:"pt-0",staticStyle:{color:"rgba(0, 0, 0, 1) !important","font-weight":"700 !important","font-size":"14px !important"},attrs:{rules:r.required?[e.rules.required]:[],readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,flat:"","background-color":"white","hide-details":"",cols:"auto"},model:{value:r.model,callback:function(t){e.$set(r,"model",t)},expression:"label_input.model"}},[e._v(" "+e._s(r.model)+" ")]):e._e(),"text"===r.type&&"members"===t.name?a("v-text-field",{staticClass:"pt-0",staticStyle:{color:"rgba(0, 0, 0, 1)","font-weight":"700 !important","font-size":"14px !important"},attrs:{rules:r.required?[e.rules.required]:[],readonly:"",disabled:"edit"!==e.mode,flat:"","background-color":"white","hide-details":"",cols:"auto"},on:{click:function(t){e.dialogAddMember=!0,e.dialogAddMemberData=r.model}},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"label_input.value"}},[e._v(" "+e._s(r.value)+" ")]):e._e(),"checkbox"===r.type?a("v-checkbox",{staticClass:"mt-2 pt-0",staticStyle:{"font-size":"14px !important",color:"rgba(0, 0, 0, 1) !important","font-weight":"700 !important"},attrs:{readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,dense:"","hide-details":"",label:r.title},model:{value:r.model,callback:function(t){e.$set(r,"model",t)},expression:"label_input.model"}}):e._e(),"select"===r.type?a("v-autocomplete",{staticClass:"pt-0",staticStyle:{"font-size":"14px !important","font-weight":"700 !important",color:"rgba(0, 0, 0, 1)"},attrs:{readonly:"edit"!==e.mode,disabled:"edit"!==e.mode,flat:"","hide-details":"","background-color":"white",multiple:r.multi,rules:r.required?[e.rules.required]:[],loading:e.loadSubCatalog,items:r.items?r.items:[],"item-text":r.itemText,"item-value":r.itemValue,"return-object":r.returnObject},on:{change:function(t){return e.changeSelect(r)}},scopedSlots:e._u(["edit"===e.mode&&"members"===t.name&&r.addTempItemIcon?{key:"prepend",fn:function(){return[a("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"400px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,o=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"control_button_add_member",attrs:{fab:"",color:"green lighten-1",dark:"",elevation:"0","x-small":"",ripple:!1},on:{click:function(t){e.dialogAddMemberData={name:null,sername:null,login:null,id:-1*(1+r.items.filter((function(e){return e.id<0})).length),project:null,role:null,role_project:null}}}},"v-btn",o,!1),n),[a("v-icon",[e._v(e._s(r.addTempItemIcon))])],1)]}}],null,!0),model:{value:r.modalAddNew,callback:function(t){e.$set(r,"modalAddNew",t)},expression:"label_input.modalAddNew"}},[a("v-card",{staticClass:"rounded-lg",attrs:{light:"",elevation:"0"}},[a("v-btn",{staticClass:"close-btn",attrs:{icon:"",light:""},on:{click:function(e){r.modalAddNew=!1}}},[a("v-icon",[e._v("mdi-close")])],1),a("v-card-title",{staticClass:"headline"},[e._v("Укажите данные учатника")]),a("v-card-text",{staticClass:"mt-2 subtitle-1"},[e._v(" После сохранения проекта будет создан новый пользователь в системе! "),a("v-form",{ref:r.formMember,refInFor:!0},[a("v-text-field",{attrs:{clearable:"","hide-details":"",label:"Имя",rules:[e.rules.required],placeholder:""},model:{value:e.dialogAddMemberData.name,callback:function(t){e.$set(e.dialogAddMemberData,"name",t)},expression:"dialogAddMemberData.name"}}),a("v-text-field",{attrs:{clearable:"","hide-details":"",rules:[e.rules.required],label:"Фамилия",placeholder:""},model:{value:e.dialogAddMemberData.sername,callback:function(t){e.$set(e.dialogAddMemberData,"sername",t)},expression:"dialogAddMemberData.sername"}}),a("v-text-field",{attrs:{clearable:"","hide-details":"auto",label:"Эл. почта",rules:[e.rules.required,e.rules.emailMatch,e.rules.doubleLogin(r,e.dialogAddMemberData.login)],placeholder:""},model:{value:e.dialogAddMemberData.login,callback:function(t){e.$set(e.dialogAddMemberData,"login",t)},expression:"dialogAddMemberData.login"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"new-btn",attrs:{text:"",dense:"",color:"primary"},on:{click:function(t){return e.addMemberLocal(r)}}},[e._v(" Сохранить ")])],1)],1)],1)]},proxy:!0}:null],null,!0),model:{value:r.model,callback:function(t){e.$set(r,"model",t)},expression:"label_input.model"}}):e._e(),"date"===r.type?a("v-menu",{attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,o=t.attrs;return[a("v-text-field",e._g(e._b({staticClass:"pt-0",staticStyle:{"font-size":"14px !important"},attrs:{disabled:"edit"!==e.mode,"background-color":"white",rules:r.required?[e.rules.required]:[],"prepend-inner-icon":"mdi-calendar",readonly:"","hide-details":"auto"},model:{value:r.model,callback:function(t){e.$set(r,"model",t)},expression:"label_input.model"}},"v-text-field",o,!1),n))]}}],null,!0)},[a("v-date-picker",{attrs:{"no-title":""},model:{value:r.model,callback:function(t){e.$set(r,"model",t)},expression:"label_input.model"}})],1):e._e()],1)})),1)],1)],1):e._e()],1)],1)],1)})),1)],1)],1)],1),a("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"400px"},model:{value:e.dialogErrorPermissions,callback:function(t){e.dialogErrorPermissions=t},expression:"dialogErrorPermissions"}},[a("v-card",{staticClass:"rounded-lg",attrs:{light:"",elevation:"0"}},[a("v-toolbar",{attrs:{color:"red",dark:"",elevation:"0"}},[e._v("Ошибка дсотупа")]),a("v-divider"),a("v-card-text",{staticClass:"mt-3 subtitle-1"},[e._v(" Данный проект для Вас не доступен! ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"new-btn",attrs:{text:"",dense:"",color:"primary"},on:{click:function(t){return e.goToLink("/")}}},[e._v(" Просмотреть свои проекты ")])],1)],1)],1)],1)},Ye=[],Qe=a("2909"),Xe=(a("a9e3"),a("4e82"),a("2ca0"),a("c740"),{loadingStartEdit:!1,currentIdProject:null,itemsSub:[],dialogAddMember:!1,dialogAddMemberData:{},optionGoTo:{duration:370,offset:80},icons:{minus:l["e"]},mode:"view",loadSubCatalog:!1,loadViewProject:!1,personalData:{name:{title:"Имя",model:"",required:!0},sername:{title:"Фамилия",model:"",required:!0},secondname:{title:"Отчество",model:"",required:!0}},allProjects:[{id:1,title:"Система управления",description:"Система описания"}],currentProject:{id:1,title:"Система управления",description:"Система описания"},extra:{},formProject:[{type:"head_select",name:"title",title:"Проект",text:null,model:null,items:[],block:"12"},{type:"textarea",name:"description",title:"Описание проекта",model:"",block:"12"},{type:"label_input_block",name:"members",block:"12",extra:{roles_project:null},edit:!0,data:[{type:"select",roleProject:"project_manager",project_worker:"project_manager",name:"userauth_0",title:"Руководитель",addTempItemIcon:"mdi-plus-thick",model:null,required:!0,block:"2",itemText:function(e){return"".concat(e.name," ").concat(e.sername)},itemValue:function(e){return e},member:!0,returnObject:!0,modalAddNew:!1,formMember:!1},{type:"select",roleProject:"member",project_worker:"analyst",name:"userauth_1",title:"Аналитик",addTempItemIcon:"mdi-plus-thick",model:null,required:!0,block:"2",member:!0,itemText:function(e){return"".concat(e.name," ").concat(e.sername)},itemValue:function(e){return e},returnObject:!0,modalAddNew:!1,formMember:!1},{type:"select",roleProject:"member",project_worker:"developer",name:"userauth_2",title:"Разработчик",addTempItemIcon:"mdi-plus-thick",model:null,required:!0,block:"2",member:!0,itemText:function(e){return"".concat(e.name," ").concat(e.sername)},itemValue:function(e){return e},returnObject:!0,modalAddNew:!1,formMember:!1},{type:"select",name:"userauth_3",project_worker:"members",roleProject:"member",title:"Участники",addTempItemIcon:"mdi-plus-thick",model:[],multi:!0,itemText:function(e){return"".concat(e.name," ").concat(e.sername)},itemValue:function(e){return e},block:"",modalAddNew:!1,formMember:!1}]},{type:"label_input_block",name:"common",block:"12",edit:!0,data:[{type:"text",name:"pbs",title:"Иерархия продуктов (PBS)",model:"",block:"2"},{type:"text",name:"wbs",title:"Ссылка на план проекта (WBS)",model:"",block:"2"},{type:"text",name:"resources",title:"Ресурсы (ссылка на ресурсный план)",model:"",block:"3"},{type:"text",name:"risks",title:"Учет рисков, возможностей, проблем",model:"",block:"3"},{type:"select",name:"id_status_project",title:"Статус",items:[],model:null,block:"2",itemText:"title",itemValue:"id",required:!0}]},{type:"label_input_block",name:"common_bool",block:"12",edit:!0,data:[{type:"checkbox",name:"products_objectives",title:"Проработана цель и продукты проекта",model:!1,block:"3"},{type:"checkbox",name:"task_plan",title:"Утвержден план задач (WBS)",model:!1,block:"3"},{type:"checkbox",name:"rp_command_time",title:"Есть РП, есть команда, есть время",model:!1,block:"3"},{type:"checkbox",name:"start_realization",title:"Проекты выведен в реализацию (2 недели стартового трекинга",model:!1,block:"3"}]},{type:"label_input_block",name:"common_date",block:"12",edit:!0,data:[{type:"date",name:"date_initiation",title:"Инициирован - дата",model:null,block:"3"},{type:"date",name:"date_start",title:"Старт - дата",model:null,block:"2"},{type:"date",name:"date_completion",title:"Завершен (принят) - дата",model:null,block:"3"},{type:"date",name:"date_frozen",title:"Заморожен - дата",model:null,block:"2"},{type:"date",name:"date_success",title:"Успешен - дата",model:null,block:"2"}]},{type:"list",hierarchy:1,start_sub_hierarchy:0,color:"red lighten-4",name:"objectives_0",name_types:"",block:"12",extra:{type_objective:null,statuses_objectives:null},description:"Зачем проект инициировали (Обоснование выполнения проекта) - главная проблема, которую решает проект для бизнеса",edit:!0,data:[]},{type:"list",hierarchy:2,start_sub_hierarchy:1,color:"red lighten-4",name:"objectives_4",name_types:"",block:"12",extra:{type_objective:null,statuses_objectives:null},description:"Цели проекта",edit:!0,data:[]},{type:"list",hierarchy:3,start_sub_hierarchy:1,color:"yellow lighten-4",name:"objectives_1",name_types:"",block:"12",extra:{type_objective:null,statuses_objectives:null},description:"Дополнительные проблемы, на решение которых может повлиять реализация вашего проекта",edit:!0,data:[]},{type:"list",hierarchy:4,start_sub_hierarchy:1,color:"blue lighten-5",name:"products_0",name_types:"",block:"12",extra:{statuses_products:null},description:"Главный Продукт в результате проекта?",edit:!0,data:[]},{type:"list",hierarchy:5,start_sub_hierarchy:1,color:"grey lighten-5",name:"products_1",name_types:"",block:"12",extra:{statuses_products:null},description:"Основные продукты проекта",edit:!0,data:[]},{type:"list",hierarchy:6,start_sub_hierarchy:1,color:"yellow lighten-4",name:"objectives_2",name_types:"",block:"12",extra:{type_objective:null,statuses_objectives:null},description:"Главный критерий успеха. Опишите способ сбора исходных данных для показателя, источники данных. Как вы сможете проверить качество данных?",edit:!0,data:[]},{type:"list",hierarchy:7,start_sub_hierarchy:1,color:"deep-purple lighten-5",name:"objectives_3",name_types:"",block:"12",extra:{type_objective:null,statuses_objectives:null},description:"Вторичные критерии успеха",edit:!0,data:[]},{type:"list",hierarchy:8,start_sub_hierarchy:1,color:"light-blue lighten-5",name:"objectives_5",name_types:"",block:"12",extra:{type_objective:null,statuses_objectives:null},description:"Условия реализации проекта",edit:!0,data:[]}]}),Ze={data:function(){return Object(i["a"])(Object(i["a"])({},Xe),B)},mounted:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.initFormProject(),"new"===e.$route.query.id&&(e.mode="edit",e.generateHierarchy()),t.next=4,e.loadExtra();case 4:if(!e.$route.query.id||"new"===e.$route.query.id){t.next=10;break}return e.currentIdProject=Number(e.$route.query.id),e.formProject[0].model=e.currentIdProject,t.next=9,e.getDataProject(e.currentIdProject);case 9:e.mode="view";case 10:case"end":return t.stop()}}),t)})))()},methods:Object(i["a"])(Object(i["a"])({},ce),{},{permission:function(){var e=this;if("new"!==this.$route.query.id){var t=this.$auth.user().projects.find((function(t){return t.id===Number(e.$route.query.id)}));return t=!!t&&t.edit,t}return!1},goToLink:function(e){location.href=e},addMemberLocal:function(e){this.$refs[e.formMember][0].validate()&&(e.errMessage="",e.items.push(this.dialogAddMemberData),e.multi?e.model.push(this.dialogAddMemberData):e.model=this.dialogAddMemberData,e.modalAddNew=!1,this.changeSelect(e))},changeSelect:function(e){if(["userauth_1","userauth_2","userauth_2"].includes(e.name)){var t=this.formProject.find((function(e){return"label_input_block"===e.type&&"members"===e.name})),a=t.data.find((function(e){return"userauth_3"===e.name}));a.model=[],a.model=d.unique(t.data.filter((function(e){return"member"===e.roleProject})).reduce((function(e,t){return e.concat(t.model)}),[]),"id"),console.log(t.data.filter((function(e){return"member"===e.roleProject})).reduce((function(e,t){return e.concat(t.model)}),[]),a.model)}},initFormProject:function(){var e=this;this.formProject.forEach((function(t){"common_date"===t.name&&(t.data[0].model="new"===e.$route.query.id?d.getToday():null)}))},getDataProject:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),t.$route.query.id=e,t.currentIdProject=Number(t.$route.query.id),t.loadSubCatalog=!0,console.log("OK!"),r={objectives_0:["Основная решаемая проблема","Решаемая проблема"],objectives_1:["Сопутствующая цель"],objectives_2:["Главный критерий успеха"],objectives_3:["Критерий успеха"],objectives_4:["Цель"],objectives_5:["Условия реализации"],products_0:!0,products_1:!1},a.next=8,t.findCatalog("projects",{id:t.currentIdProject,title:null});case 8:n=a.sent.data.items[0],n?(t.formProject=t.formProject.map((function(e){if("description"===e.name&&(e.model=n[e.name]),"members"===e.name){e.data[e.data.length-1].model=[];var t=n.members.filter((function(e){return e.project_worker})).sort((function(e,t){return e.id-t.id}));e.data=e.data.map((function(a){var r,n="members"===a.project_worker?t.filter((function(e){return e.project_worker===a.project_worker})):t.find((function(e){return e.project_worker===a.project_worker})),o=n?"members"===a.project_worker?a.items.filter((function(e){return n.map((function(e){return e.id})).includes(e.id)})):a.items.find((function(e){return e.id===n.id})):null;(console.log("modelMember",o),"members"===a.project_worker)?(o=o||[],(r=a.model).push.apply(r,Object(Qe["a"])(o))):(a.model=o,["analyst","developer"].includes(a.project_worker)&&e.data[e.data.length-1].model.push(o));return a}))}return"title"===e.name&&"head_select"===e.type&&(e.text=n[e.name]),["common","common_bool","common_date"].includes(e.name)&&(e.data=e.data.map((function(e){return e.model=n[e.name],e}))),"list"===e.type&&e.name.startsWith("objectives")&&(n.objectives?(e.data=n.objectives.filter((function(t){return e.extra.type_objective.filter((function(t){return r[e.name].includes(t.title)})).map((function(e){return e.id})).includes(t.id_type_objective)&&t.id_status_objective!==e.extra.statuses_objectives.find((function(e){return"архив"===e.title.toLowerCase()})).id})),e.data=e.data.map((function(t){return(t.id_parent_objective||0===t.id_parent_objective)&&(t.parent=e.data.findIndex((function(e){return e.id===t.id_parent_objective}))),t}))):e.data=[]),"list"===e.type&&e.name.startsWith("products")&&(n.products?(e.data=n.products.filter((function(t){return t.main===r[e.name]&&t.id_status_product!==e.extra.statuses_products.find((function(e){return"архив"===e.title.toLowerCase()})).id})),e.data=e.data.map((function(t){return(t.id_parent_product||0===t.id_parent_product)&&(t.parent=e.data.findIndex((function(e){return e.id===t.id_parent_product}))),t}))):e.data=[]),e})),console.log(n),t.generateHierarchy()):t.dialogErrorPermissions=!0,t.loadSubCatalog=!1;case 11:case"end":return a.stop()}}),a)})))()},loadExtra:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loadSubCatalog=!0,t.next=3,e.getSubCatalog("roles_project");case 3:return t.next=5,e.getSubCatalog("userauth");case 5:return t.next=7,e.getSubCatalog("id_status_project");case 7:return t.next=9,e.getSubCatalog("type_objective");case 9:return t.next=11,e.getSubCatalog("statuses_objectives");case 11:return t.next=13,e.getSubCatalog("statuses_products");case 13:return t.next=15,e.getSubCatalog("projects");case 15:e.loadSubCatalog=!1;case 16:case"end":return t.stop()}}),t)})))()},getSubCatalog:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getCatalog(t.prepareSubCatalogsNAme(e));case 2:return t.itemsSub=a.sent.data.items,t.formProject.forEach((function(a){"label_input_block"===a.type&&a.data.forEach((function(r){"members"===a.name?(console.log(r.name),r.name.split("_")[0]===e&&(r.items=t.itemsSub),a.extra[e]=t.itemsSub):r.name===e&&(r.items=t.itemsSub)})),"list"===a.type&&(a.extra[e]=t.itemsSub),"head_select"===a.type&&(console.log("this.allProjects",t.itemsSub),t.allProjects=t.itemsSub)})),a.abrupt("return",t.itemsSub);case 5:case"end":return a.stop()}}),a)})))()},saveEditProject:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.formProjectData.validate()){t.next=17;break}if(a=e.formProject.reduce((function(e,t){var a=e.concat("common"===t.name||"common_bool"===t.name||"common_date"===t.name?t.data:t);return a}),[]).reduce((function(t,a){var r=a.model,n=a.name;return"members"===a.name&&(r=a.data.reduce((function(t,r){var n=r.model,o=Array.isArray(n)?n.map((function(t){return Object(i["a"])({roleProject:r.roleProject,project_worker:r.project_worker,id_user:t.id,id_project:e.currentIdProject,id_role_project:a.extra.roles_project.find((function(e){return e.name===r.roleProject})).id},t)})):Object(i["a"])({roleProject:r.roleProject,project_worker:r.project_worker,id_user:n.id,id_project:e.currentIdProject,id_role_project:a.extra.roles_project.find((function(e){return e.name===r.roleProject})).id},n);return t.concat(o)}),[]),r=r.filter((function(e){return"project_manager"===e.roleProject})).concat(d.unique(r.filter((function(e){return"project_manager"!==e.roleProject})),"id_user"))),"title"===a.name&&"head_select"===a.type&&e.$route.query.id&&"number"===typeof e.$route.query.id&&(r=a.text),(a.name.startsWith("objectives")||a.name.startsWith("products"))&&"list"===a.type&&(r=a.data),Object(i["a"])(Object(i["a"])({},t),Object(q["a"])({},n,r))}),{}),console.log(a),e.loadSubCatalog=!0,a.creator=e.$auth.user(),"new"!==e.$route.query.id){t.next=12;break}return t.next=8,e.addToCatalog("projects",a);case 8:r=t.sent.data,location.href="/view/project?id="+r,t.next=15;break;case 12:return t.next=14,e.updateToCatalog("projects",a,e.currentIdProject);case 14:location.href="/view/project?id="+e.currentIdProject;case 15:e.loadSubCatalog=!1,e.mode="view";case 17:case"end":return t.stop()}}),t)})))()},cancelEditProject:function(){"new"!==this.$route.query.id&&(this.mode="view"),this.generateHierarchy()},addEntityLocal:function(e){var t=this;e.data.push({ref:"newEntityLoad",title:"",description:"",priority:1,id_project:null}),setTimeout((function(){t.$vuetify.goTo(t.$refs.newEntityLoad[0],t.optionGoTo),t.initRef(),t.generateHierarchy()}),100)},initRef:function(){this.formProject.forEach((function(e){"list"===e.type&&(e.ref=void 0,e.data=e.data.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{ref:void 0})})))}))},removeEntityLocal:function(e,t){var a=this;console.log("remove-IN",t),t.remove=!0,t.parent=void 0,e.ref="removeBlockEntity",e.data=e.data.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{parent:e.parent===t.index?void 0:e.parent})})),setTimeout((function(){a.$vuetify.goTo(a.$refs.removeBlockEntity[0],a.optionGoTo),a.initRef(),a.generateHierarchy()}),100)},generateHierarchy:function(){for(var e=this,t=0;t<this.formProject.length;t++){var a=this.formProject[t];console.log(a.type);var r=-1,n=-1;if("list"===a.type)for(var o=function(t){var o=a.data[t];o.remove||o.parent||0===o.parent||r++,o.remove||n++;var i=a.data.find((function(e){return o.parent===e.index})),l=i?i.hierarchy:null,s=d.groupBy(a.data.filter((function(e){return e.parent||0===e.parent})),(function(e){return[e.parent]}));o.index=t,o.hierarchy=o.parent||0===o.parent?"".concat(l,".").concat(1+s.find((function(e){return e[0].parent===o.parent})).findIndex((function(e){return e.index===o.index}))):"".concat(a.hierarchy,".").concat(r+a.start_sub_hierarchy),"objectives_0"===a.name&&(o.id_status_objective=a.extra.statuses_objectives.find((function(e){return"активный"===e.title})),console.log(a.name,n,a.start_sub_hierarchy,o.hierarchy),n+a.start_sub_hierarchy===0?o.id_type_objective=a.extra.type_objective.find((function(e){return"Основная решаемая проблема"===e.title})):o.id_type_objective=a.extra.type_objective.find((function(e){return"Решаемая проблема"===e.title}))),"objectives_1"===a.name&&(o.id_type_objective=a.extra.type_objective.find((function(e){return"Сопутствующая цель"===e.title})),o.id_status_objective=a.extra.statuses_objectives.find((function(e){return"активный"===e.title}))),"products_0"===a.name&&(o.main=!0,"new"===e.$route.query.id&&(o.date_create=d.getToday()),o.id_status_product=a.extra.statuses_products.find((function(e){return"активный"===e.title}))),"products_1"===a.name&&("new"===e.$route.query.id&&(o.date_create=d.getToday()),o.id_status_product=a.extra.statuses_products.find((function(e){return"активный"===e.title}))),"objectives_2"===a.name&&(o.id_type_objective=a.extra.type_objective.find((function(e){return"Главный критерий успеха"===e.title})),o.id_status_objective=a.extra.statuses_objectives.find((function(e){return"активный"===e.title}))),"objectives_3"===a.name&&(o.id_type_objective=a.extra.type_objective.find((function(e){return"Критерий успеха"===e.title})),o.id_status_objective=a.extra.statuses_objectives.find((function(e){return"активный"===e.title}))),"objectives_4"===a.name&&(o.id_type_objective=a.extra.type_objective.find((function(e){return"Цель"===e.title})),o.id_status_objective=a.extra.statuses_objectives.find((function(e){return"активный"===e.title}))),"objectives_5"===a.name&&(o.id_type_objective=a.extra.type_objective.find((function(e){return"Условия реализации"===e.title})),o.id_status_objective=a.extra.statuses_objectives.find((function(e){return"активный"===e.title})))},i=0;i<a.data.length;i++)o(i)}this.formProject=this.formProject.map((function(e){return e})),console.log(this.formProject)}})},et=Ze,tt=(a("cb99"),Object(p["a"])(et,Ke,Ye,!1,null,"1d639d35",null)),at=tt.exports;r["default"].use(w["a"]);var rt=new w["a"]({mode:"history",routes:[{path:"/",name:"projects",component:pe,meta:{auth:!0}},{path:"/view/project/",name:"viewProject",component:at,meta:{auth:!0}},{path:"/objectives",name:"objectives",component:we,meta:{auth:"admin"}},{path:"/products",name:"products",component:Se,meta:{auth:"admin"}},{path:"/members",name:"members",component:De,meta:{auth:"admin"}},{path:"/login",name:"login",component:C},{path:"/register",name:"register",component:E},{path:"/settings",name:"Настройки",component:Le,meta:{auth:!0}},{path:"/settings/catalogs",name:"Настройка каталогов",component:Ge,meta:{auth:"admin"}}]});r["default"].router=rt;var nt=rt,ot=a("ce5b"),it=a.n(ot);a("bf40");r["default"].use(it.a);var lt={icons:{iconfont:"mdiSvg"}},st=new it.a(lt),ct=a("3a60"),dt=a.n(ct),ut=a("6c42"),mt=(a("da96"),a("94e9")),pt=a("2f62");r["default"].use(pt["a"]);var ft=new pt["a"].Store({});r["default"].store=ft;var ht=ft;r["default"].use(mt["a"],{authMeta:"auth",rolesVar:"role",tokenDefaultName:"project_roken",userDefaultName:"project_auth_user",tokenStore:["localStorage","vuex"],headerTokenReplace:"{auth_token}",tokenType:"Bearer",vuexStoreSpace:"vue-auth",authRedirect:"/login",loginData:{url:"/api/auth/authenticate",method:"POST",redirect:"",headerToken:"Authorization",fetchUser:!0,fetchData:function(e){return e.data.user},customToken:function(e){return e.data.token}},registerData:{url:"/api/auth/register",method:"POST",redirect:void 0,headerToken:"Authorization",fetchUser:!1,fetchData:function(e){return e.data.user},customToken:function(e){return e.data.token}},logoutData:{redirect:"/login"},fetchData:{url:"/api/auth/user",method:"GET",enabled:!0},refreshData:{url:"/api/auth/refresh",method:"GET",enabled:!0}});var gt={draggable:!1};r["default"].config.productionTip=!1,r["default"].use(ut["a"],gt),r["default"].use(w["a"]),r["default"].use(dt.a),r["default"].use(mt["a"]),new r["default"]({vuetify:st,store:ht,render:function(e){return e(_)},router:nt}).$mount("#app")},"85ec":function(e,t,a){},"9c6d":function(e,t,a){},ae97:function(e,t,a){},b13e:function(e,t,a){},cb99:function(e,t,a){"use strict";a("ae97")},d59d:function(e,t,a){"use strict";a("9c6d")},fec3:function(e,t,a){"use strict";a("b13e")}});
//# sourceMappingURL=app.a978ab7b.js.map